(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7586],{2898:function(e,a,s){"use strict";s.d(a,{Z:function(){return createLucideIcon}});var t=s(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,a)=>{let s=(0,t.forwardRef)(({color:s="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:c,children:i,...o},d)=>(0,t.createElement)("svg",{ref:d,...r,width:l,height:l,stroke:s,strokeWidth:c?24*Number(n)/Number(l):n,className:`lucide lucide-${toKebabCase(e)}`,...o},[...a.map(([e,a])=>(0,t.createElement)(e,a)),...(Array.isArray(i)?i:[i])||[]]));return s.displayName=`${e}`,s}},3067:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var t=s(2898);let r=(0,t.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6245:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});var t=s(2898);let r=(0,t.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},9801:function(e,a,s){Promise.resolve().then(s.bind(s,4755))},4755:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return EditClassPage}});var t=s(7437),r=s(2265),l=s(4033),n=s(1396),c=s.n(n),i=s(3067),o=s(6245),d=s(6454);function EditClassPage(){let e=(0,l.useParams)(),a=(0,l.useRouter)(),s=e.id,[n,u]=(0,r.useState)(!0),[m,h]=(0,r.useState)(!1),[f,p]=(0,r.useState)(""),[x,j]=(0,r.useState)([]),[b,g]=(0,r.useState)(!0),[N,v]=(0,r.useState)({name:"",grade:"",section:"",academicYear:"",maxStudents:30,description:"",subjects:"",syllabus:"",rules:"",classTeacherId:"",startDate:"",endDate:"",status:"ACTIVE"});(0,r.useEffect)(()=>{let fetchTeachers=async()=>{try{let e=(0,d.hV)();if(!e)return;let a=await (0,d.R1)("/teachers",{token:e});j(a)}catch(e){console.error("Error fetching teachers:",e)}finally{g(!1)}};fetchTeachers()},[]),(0,r.useEffect)(()=>{let fetchClassDetails=async()=>{try{u(!0);let e=(0,d.hV)();if(!e)throw Error("Authentication required");let a=await (0,d.R1)("/classes/".concat(s),{token:e}),t="";a.subjects&&(t=Array.isArray(a.subjects)?a.subjects.join(", "):"object"==typeof a.subjects?Object.values(a.subjects).join(", "):a.subjects),v({name:a.name||"",grade:a.grade||"",section:a.section||"",academicYear:a.academicYear||"",maxStudents:a.maxStudents||30,description:a.description||"",subjects:t,syllabus:a.syllabus||"",rules:a.rules||"",classTeacherId:a.classTeacherId?a.classTeacherId.toString():"",startDate:a.startDate?a.startDate.split("T")[0]:"",endDate:a.endDate?a.endDate.split("T")[0]:"",status:a.status||"ACTIVE"})}catch(e){console.error("Error fetching class details:",e),p((null==e?void 0:e.message)||"Failed to fetch class details")}finally{u(!1)}};s&&fetchClassDetails()},[s]);let handleSubmit=async e=>{e.preventDefault();try{h(!0);let e=(0,d.hV)();if(!e)throw Error("Authentication required");let t={name:N.name,grade:N.grade,section:N.section,academicYear:N.academicYear,maxStudents:parseInt(N.maxStudents.toString()),description:N.description,syllabus:N.syllabus,rules:N.rules,status:N.status};if(N.subjects)try{t.subjects=JSON.parse(N.subjects)}catch(e){t.subjects=N.subjects.split(",").map(e=>e.trim())}N.startDate&&(t.startDate=new Date(N.startDate)),N.endDate&&(t.endDate=new Date(N.endDate)),N.classTeacherId&&(t.classTeacherId=parseInt(N.classTeacherId));let r=await fetch("".concat(d.CT,"/classes/").concat(s),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to update class")}alert("Class updated successfully!"),a.push("/school-admin/classes")}catch(e){console.error("Error updating class:",e),alert((null==e?void 0:e.message)||"Failed to update class")}finally{h(!1)}};return n?(0,t.jsx)("div",{className:"container-fluid",children:(0,t.jsxs)("div",{className:"text-center py-5",children:[(0,t.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,t.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,t.jsx)("p",{className:"mt-3 text-muted",children:"Loading class details..."})]})}):f?(0,t.jsx)("div",{className:"container-fluid",children:(0,t.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[(0,t.jsx)("h5",{className:"alert-heading",children:"Error"}),(0,t.jsx)("p",{children:f}),(0,t.jsx)("hr",{}),(0,t.jsx)(c(),{href:"/school-admin/classes",className:"btn btn-outline-danger",children:"Back to Classes"})]})}):(0,t.jsxs)("div",{className:"container-fluid",children:[(0,t.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:(0,t.jsxs)("div",{className:"d-flex align-items-center",children:[(0,t.jsx)(c(),{href:"/school-admin/classes",className:"btn btn-outline-secondary me-3",children:(0,t.jsx)(i.Z,{size:20})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"h3 mb-0",children:"Edit Class"}),(0,t.jsx)("p",{className:"text-muted mb-0",children:"Update class information"})]})]})}),(0,t.jsx)("div",{className:"row justify-content-center",children:(0,t.jsx)("div",{className:"col-lg-10",children:(0,t.jsx)("div",{className:"card",children:(0,t.jsx)("div",{className:"card-body p-4",children:(0,t.jsx)("form",{onSubmit:handleSubmit,children:(0,t.jsxs)("div",{className:"row g-4",children:[(0,t.jsx)("div",{className:"col-12",children:(0,t.jsx)("h5",{className:"border-bottom pb-2 mb-3",children:"Basic Information"})}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsxs)("label",{className:"form-label",children:["Class Name ",(0,t.jsx)("span",{className:"text-danger",children:"*"})]}),(0,t.jsx)("input",{type:"text",className:"form-control",value:N.name,onChange:e=>v({...N,name:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"col-md-3",children:[(0,t.jsxs)("label",{className:"form-label",children:["Grade ",(0,t.jsx)("span",{className:"text-danger",children:"*"})]}),(0,t.jsx)("input",{type:"text",className:"form-control",value:N.grade,onChange:e=>v({...N,grade:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"col-md-3",children:[(0,t.jsxs)("label",{className:"form-label",children:["Section ",(0,t.jsx)("span",{className:"text-danger",children:"*"})]}),(0,t.jsx)("input",{type:"text",className:"form-control",value:N.section,onChange:e=>v({...N,section:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsx)("label",{className:"form-label",children:"Academic Year"}),(0,t.jsx)("input",{type:"text",className:"form-control",placeholder:"e.g., 2024-2025",value:N.academicYear,onChange:e=>v({...N,academicYear:e.target.value})})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsxs)("label",{className:"form-label",children:["Max Students ",(0,t.jsx)("span",{className:"text-danger",children:"*"})]}),(0,t.jsx)("input",{type:"number",className:"form-control",value:N.maxStudents,onChange:e=>v({...N,maxStudents:parseInt(e.target.value)}),required:!0})]}),(0,t.jsxs)("div",{className:"col-12",children:[(0,t.jsx)("label",{className:"form-label",children:"Description"}),(0,t.jsx)("textarea",{className:"form-control",rows:3,value:N.description,onChange:e=>v({...N,description:e.target.value})})]}),(0,t.jsx)("div",{className:"col-12 mt-4",children:(0,t.jsx)("h5",{className:"border-bottom pb-2 mb-3",children:"Academic Details"})}),(0,t.jsxs)("div",{className:"col-12",children:[(0,t.jsx)("label",{className:"form-label",children:"Subjects (comma-separated or JSON)"}),(0,t.jsx)("textarea",{className:"form-control",rows:2,placeholder:"e.g., Math, Science, English",value:N.subjects,onChange:e=>v({...N,subjects:e.target.value})})]}),(0,t.jsxs)("div",{className:"col-12",children:[(0,t.jsx)("label",{className:"form-label",children:"Syllabus"}),(0,t.jsx)("textarea",{className:"form-control",rows:3,value:N.syllabus,onChange:e=>v({...N,syllabus:e.target.value})})]}),(0,t.jsxs)("div",{className:"col-12",children:[(0,t.jsx)("label",{className:"form-label",children:"Rules"}),(0,t.jsx)("textarea",{className:"form-control",rows:3,value:N.rules,onChange:e=>v({...N,rules:e.target.value})})]}),(0,t.jsx)("div",{className:"col-12 mt-4",children:(0,t.jsx)("h5",{className:"border-bottom pb-2 mb-3",children:"Teacher & Schedule"})}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsx)("label",{className:"form-label",children:"Class Teacher"}),(0,t.jsxs)("select",{className:"form-select",value:N.classTeacherId,onChange:e=>v({...N,classTeacherId:e.target.value}),disabled:b,children:[(0,t.jsx)("option",{value:"",children:b?"Loading teachers...":"Select Class Teacher (Optional)"}),x.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsx)("label",{className:"form-label",children:"Status"}),(0,t.jsxs)("select",{className:"form-select",value:N.status,onChange:e=>v({...N,status:e.target.value}),children:[(0,t.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,t.jsx)("option",{value:"INACTIVE",children:"Inactive"}),(0,t.jsx)("option",{value:"COMPLETED",children:"Completed"})]})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsx)("label",{className:"form-label",children:"Start Date"}),(0,t.jsx)("input",{type:"date",className:"form-control",value:N.startDate,onChange:e=>v({...N,startDate:e.target.value})})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[(0,t.jsx)("label",{className:"form-label",children:"End Date"}),(0,t.jsx)("input",{type:"date",className:"form-control",value:N.endDate,onChange:e=>v({...N,endDate:e.target.value})})]}),(0,t.jsx)("div",{className:"col-12 mt-4",children:(0,t.jsxs)("div",{className:"d-flex gap-3 justify-content-end",children:[(0,t.jsx)(c(),{href:"/school-admin/classes",className:"btn btn-secondary",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Z,{size:16,className:"me-2"}),"Update Class"]})})]})})]})})})})})})]})}},6454:function(e,a,s){"use strict";s.d(a,{CT:function(){return t},MS:function(){return ApiError},QW:function(){return apiDelete},R1:function(){return apiGet},Uh:function(){return clearAuthData},c7:function(){return storeUser},hV:function(){return getStoredToken},mB:function(){return storeToken},nc:function(){return apiPatch},pE:function(){return apiPut},sg:function(){return apiPost},vF:function(){return getStoredUser}});let t="http://localhost:3001";let ApiError=class ApiError extends Error{constructor(e,a,s){super(a),this.status=e,this.message=a,this.data=s,this.name="ApiError"}};async function apiRequest(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:s,params:r,headers:l,...n}=a,c="".concat(t).concat(e);if(r){let e=new URLSearchParams(Object.entries(r).reduce((e,a)=>{let[s,t]=a;return null!=t&&(e[s]=String(t)),e},{})).toString();e&&(c+="?".concat(e))}let i={"Content-Type":"application/json",...l};s&&(i.Authorization="Bearer ".concat(s));try{let e=await fetch(c,{...n,headers:i}),a=await e.json().catch(()=>({}));if(!e.ok)throw new ApiError(e.status,a.message||"Request failed with status ".concat(e.status),a);return a}catch(e){if(e instanceof ApiError)throw e;throw new ApiError(0,e instanceof Error?e.message:"Network error occurred")}}async function apiGet(e,a){return apiRequest(e,{...a,method:"GET"})}async function apiPost(e,a,s){return apiRequest(e,{...s,method:"POST",body:a?JSON.stringify(a):void 0})}async function apiPut(e,a,s){return apiRequest(e,{...s,method:"PUT",body:a?JSON.stringify(a):void 0})}async function apiPatch(e,a,s){return apiRequest(e,{...s,method:"PATCH",body:a?JSON.stringify(a):void 0})}async function apiDelete(e,a){return apiRequest(e,{...a,method:"DELETE"})}function getStoredToken(){return localStorage.getItem("token")}function storeToken(e){localStorage.setItem("token",e)}function removeToken(){localStorage.removeItem("token")}function getStoredUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}function storeUser(e){localStorage.setItem("user",JSON.stringify(e))}function removeUser(){localStorage.removeItem("user")}function clearAuthData(){removeToken(),removeUser(),localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),localStorage.removeItem("userData")}},4033:function(e,a,s){e.exports=s(94)}},function(e){e.O(0,[1176,2971,2472,1744],function(){return e(e.s=9801)}),_N_E=e.O()}]);