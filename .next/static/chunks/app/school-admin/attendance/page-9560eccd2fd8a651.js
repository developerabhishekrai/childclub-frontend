(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5717],{2898:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var a=s(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:c=24,strokeWidth:r=2,absoluteStrokeWidth:l,children:d,...i},o)=>(0,a.createElement)("svg",{ref:o,...n,width:c,height:c,stroke:s,strokeWidth:l?24*Number(r)/Number(c):r,className:`lucide lucide-${toKebabCase(e)}`,...i},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...(Array.isArray(d)?d:[d])||[]]));return s.displayName=`${e}`,s}},8203:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},3008:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5817:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},5367:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5750:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2104:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},7935:function(e,t,s){Promise.resolve().then(s.bind(s,5602))},5602:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return SchoolAdminAttendancePage}});var a=s(7437),n=s(9738),c=s.n(n),r=s(2265),l=s(3008),d=s(2104),i=s(6141),o=s(8203),m=s(5817),h=s(5750),x=s(5367),u=s(6820),b=s.n(u),f=s(6454);function SchoolAdminAttendancePage(){var e,t;let[s,n]=(0,r.useState)(!0),[u,j]=(0,r.useState)([]),[g,p]=(0,r.useState)(null),[y,N]=(0,r.useState)([]),[v,w]=(0,r.useState)(new Date().toISOString().split("T")[0]),[k,S]=(0,r.useState)([]),[A,C]=(0,r.useState)({totalDays:0,present:0,absent:0,late:0,excused:0,attendancePercentage:0}),[D,E]=(0,r.useState)("daily"),[I,T]=(0,r.useState)(new Date().getMonth()),[M,R]=(0,r.useState)(new Date().getFullYear());(0,r.useEffect)(()=>{fetchClasses()},[]),(0,r.useEffect)(()=>{g&&(fetchClassStudents(),fetchDailyAttendance(),"monthly"===D&&fetchMonthlyStats())},[g,v,D,I,M]);let fetchClasses=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("".concat(f.CT,"/classes"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();j(e)}}catch(e){console.error("Error fetching classes:",e)}finally{n(!1)}},fetchClassStudents=async()=>{if(g)try{let e=localStorage.getItem("token"),t=await fetch("".concat(f.CT,"/students/class/").concat(g),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();console.log("Fetched students for class:",g,"Count:",e.length),N(e)}}catch(e){console.error("Error fetching students:",e)}},fetchDailyAttendance=async()=>{if(g)try{let e=localStorage.getItem("token"),t=await fetch("".concat(f.CT,"/attendance/class/").concat(g,"?date=").concat(v),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();console.log("Fetched attendance records:",e),console.log("For class:",g,"Date:",v),S(e)}else console.error("Failed to fetch attendance:",t.status)}catch(e){console.error("Error fetching attendance:",e)}},fetchMonthlyStats=async()=>{if(g)try{let e=localStorage.getItem("token"),t=new Date(M,I,1).toISOString().split("T")[0],s=new Date(M,I+1,0).toISOString().split("T")[0],a=await fetch("".concat(f.CT,"/attendance/class/").concat(g,"?startDate=").concat(t,"&endDate=").concat(s),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();S(e)}}catch(e){console.error("Error fetching monthly attendance:",e)}},handleMarkAttendance=async()=>{var e;if(!g||0===y.length){b().fire({icon:"warning",title:"Warning",text:"Please select a class with students"});return}let t=await b().fire({title:"Mark Attendance",html:'\n        <div class="text-start">\n          <p><strong>Class:</strong> '.concat(null===(e=u.find(e=>e.id===g))||void 0===e?void 0:e.name,"</p>\n          <p><strong>Date:</strong> ").concat(v,"</p>\n          <p><strong>Students:</strong> ").concat(y.length,'</p>\n          <hr />\n          <p class="text-muted small">Mark all students as present by default?</p>\n        </div>\n      '),showCancelButton:!0,confirmButtonText:"Mark All Present",cancelButtonText:"Custom Entry",showDenyButton:!0,denyButtonText:"Cancel"});if(t.isConfirmed){let e=y.map(e=>({studentId:e.userId,status:"present"}));await submitAttendance(e)}else"cancel"===t.dismiss&&showCustomAttendanceForm()},showCustomAttendanceForm=()=>{let e=y.map(e=>'\n      <div class="d-flex align-items-center justify-content-between mb-3 p-2 border rounded">\n        <div class="flex-grow-1">\n          <strong>'.concat(e.firstName," ").concat(e.lastName,'</strong>\n          <br />\n          <small class="text-muted">Roll: ').concat(e.enrollmentNumber||"N/A",'</small>\n        </div>\n        <select class="form-select form-select-sm w-auto student-status" data-student-id="').concat(e.userId,'">\n          <option value="present">Present</option>\n          <option value="absent">Absent</option>\n          <option value="late">Late</option>\n          <option value="excused">Excused</option>\n        </select>\n      </div>\n    ')).join("");b().fire({title:"Mark Attendance",html:'\n        <div class="text-start" style="max-height: 400px; overflow-y: auto;">\n          '.concat(e,"\n        </div>\n      "),width:"600px",showCancelButton:!0,confirmButtonText:"Submit",preConfirm:()=>{let e=document.querySelectorAll(".student-status"),t=[];return e.forEach(e=>{t.push({studentId:parseInt(e.dataset.studentId),status:e.value})}),t}}).then(e=>{e.isConfirmed&&e.value&&submitAttendance(e.value)})},submitAttendance=async e=>{try{let t=localStorage.getItem("token"),s={classId:g,date:v,attendance:e};console.log("Submitting attendance:",s);let a=await fetch("".concat(f.CT,"/attendance"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(s)}),n=await a.json();if(console.log("Attendance response:",n),a.ok)b().fire({icon:"success",title:"Success",text:"Attendance marked successfully!",timer:2e3,showConfirmButton:!1}),fetchDailyAttendance();else throw Error(n.message||"Failed to mark attendance")}catch(e){console.error("Error submitting attendance:",e),b().fire({icon:"error",title:"Error",text:e.message||"Failed to mark attendance"})}},handleDeleteRecord=async e=>{let t=await b().fire({title:"Delete Record?",text:"Are you sure you want to delete this attendance record?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it"});if(t.isConfirmed)try{let t=localStorage.getItem("token"),s=await fetch("".concat(f.CT,"/attendance/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});s.ok&&(b().fire({icon:"success",title:"Deleted!",text:"Record deleted successfully",timer:2e3,showConfirmButton:!1}),fetchDailyAttendance())}catch(e){console.error("Error deleting record:",e),b().fire({icon:"error",title:"Error",text:"Failed to delete record"})}},getStatusColor=e=>{switch(e){case"present":return"success";case"absent":return"danger";case"late":return"warning";case"excused":return"info";default:return"secondary"}},getStatusIcon=e=>{switch(e){case"present":return(0,a.jsx)(l.Z,{size:18});case"absent":return(0,a.jsx)(d.Z,{size:18});case"late":return(0,a.jsx)(i.Z,{size:18});case"excused":return(0,a.jsx)(o.Z,{size:18});default:return null}},P=(()=>{let e={present:0,absent:0,late:0,excused:0,total:k.length,attendancePercentage:0};return k.forEach(t=>{switch(t.status){case"present":e.present++;break;case"absent":e.absent++;break;case"late":e.late++;break;case"excused":e.excused++}}),e.total>0&&(e.attendancePercentage=Math.round((e.present+e.late)/e.total*100)),e})();if(s)return(0,a.jsx)("div",{className:"container-fluid vh-100 d-flex justify-content-center align-items-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"spinner-border text-primary",role:"status",style:{width:"4rem",height:"4rem"},children:(0,a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,a.jsx)("h4",{className:"mt-3",children:"Loading Attendance..."})]})});let z=["January","February","March","April","May","June","July","August","September","October","November","December"];return(0,a.jsxs)("div",{style:{background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh"},className:"jsx-d104eb44e71cef75",children:[(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 container-fluid p-4",children:[(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 row mb-4",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 col-12",children:(0,a.jsx)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},className:"jsx-d104eb44e71cef75 card border-0 shadow-lg",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 card-body text-white p-4",children:[(0,a.jsxs)("h1",{className:"jsx-d104eb44e71cef75 display-5 fw-bold mb-2",children:[(0,a.jsx)(o.Z,{size:50,className:"me-3"}),"Attendance Management"]}),(0,a.jsx)("p",{className:"jsx-d104eb44e71cef75 mb-0 opacity-75",children:"Manage and track student attendance"})]})})})}),(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 row mb-4",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 col-12",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card border-0 shadow",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-body",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 row g-3 align-items-end",children:[(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 col-12 col-md-3",children:[(0,a.jsx)("label",{className:"jsx-d104eb44e71cef75 form-label fw-semibold",children:"Select Class"}),(0,a.jsxs)("select",{value:g||"",onChange:e=>p(Number(e.target.value)),className:"jsx-d104eb44e71cef75 form-select",children:[(0,a.jsx)("option",{value:"",className:"jsx-d104eb44e71cef75",children:"Choose a class..."}),u.map(e=>(0,a.jsx)("option",{value:e.id,className:"jsx-d104eb44e71cef75",children:e.name},e.id))]})]}),"daily"===D?(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 col-12 col-md-3",children:[(0,a.jsx)("label",{className:"jsx-d104eb44e71cef75 form-label fw-semibold",children:"Date"}),(0,a.jsx)("input",{type:"date",value:v,onChange:e=>w(e.target.value),className:"jsx-d104eb44e71cef75 form-control"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 col-12 col-md-2",children:[(0,a.jsx)("label",{className:"jsx-d104eb44e71cef75 form-label fw-semibold",children:"Month"}),(0,a.jsx)("select",{value:I,onChange:e=>T(Number(e.target.value)),className:"jsx-d104eb44e71cef75 form-select",children:z.map((e,t)=>(0,a.jsx)("option",{value:t,className:"jsx-d104eb44e71cef75",children:e},t))})]}),(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 col-12 col-md-2",children:[(0,a.jsx)("label",{className:"jsx-d104eb44e71cef75 form-label fw-semibold",children:"Year"}),(0,a.jsx)("select",{value:M,onChange:e=>R(Number(e.target.value)),className:"jsx-d104eb44e71cef75 form-select",children:[2023,2024,2025,2026].map(e=>(0,a.jsx)("option",{value:e,className:"jsx-d104eb44e71cef75",children:e},e))})]})]}),(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 col-12 col-md-2",children:[(0,a.jsx)("label",{className:"jsx-d104eb44e71cef75 form-label fw-semibold",children:"View"}),(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 btn-group w-100",children:[(0,a.jsx)("button",{onClick:()=>E("daily"),className:"jsx-d104eb44e71cef75 "+"btn ".concat("daily"===D?"btn-primary":"btn-outline-primary"),children:"Daily"}),(0,a.jsx)("button",{onClick:()=>E("monthly"),className:"jsx-d104eb44e71cef75 "+"btn ".concat("monthly"===D?"btn-primary":"btn-outline-primary"),children:"Stats"})]})]}),(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 col-12 col-md-4",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 d-flex gap-2",children:[(0,a.jsxs)("button",{onClick:handleMarkAttendance,disabled:!g,className:"jsx-d104eb44e71cef75 btn btn-success flex-grow-1",children:[(0,a.jsx)(l.Z,{size:18,className:"me-2"}),"Mark Attendance"]}),(0,a.jsx)("button",{onClick:()=>{if(0===k.length){b().fire({icon:"warning",title:"No Data",text:"No attendance records to export"});return}let e=[["Date","Student Name","Roll Number","Status","Mood","Remarks"],...k.map(e=>{var t,s,a;return[e.date,"".concat((null===(t=e.student)||void 0===t?void 0:t.firstName)||""," ").concat((null===(s=e.student)||void 0===s?void 0:s.lastName)||""),(null===(a=e.student)||void 0===a?void 0:a.enrollmentNumber)||"N/A",e.status,e.mood||"",e.remarks||""]})].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="attendance-".concat(v,".csv"),a.click(),window.URL.revokeObjectURL(s)},disabled:!g||0===k.length,className:"jsx-d104eb44e71cef75 btn btn-outline-primary",children:(0,a.jsx)(m.Z,{size:18})})]})})]})})})})}),g&&y.length>0&&(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 row mb-4",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 col-12",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 card border-0 shadow",children:[(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-header bg-white border-0 py-3",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 d-flex justify-content-between align-items-center",children:[(0,a.jsxs)("h5",{className:"jsx-d104eb44e71cef75 mb-0 fw-bold",children:[(0,a.jsx)(h.Z,{size:24,className:"me-2"}),"Students - ",null===(e=u.find(e=>e.id===g))||void 0===e?void 0:e.name]}),(0,a.jsxs)("span",{className:"jsx-d104eb44e71cef75 badge bg-primary fs-6",children:[y.length," Students"]})]})}),(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-body p-0",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 table-responsive",children:(0,a.jsxs)("table",{className:"jsx-d104eb44e71cef75 table table-hover mb-0",children:[(0,a.jsx)("thead",{className:"jsx-d104eb44e71cef75 bg-light",children:(0,a.jsxs)("tr",{className:"jsx-d104eb44e71cef75",children:[(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"S.No"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Student Name"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Enrollment Number"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Attendance Status"})]})}),(0,a.jsx)("tbody",{className:"jsx-d104eb44e71cef75",children:y.map((e,t)=>{let s=k.find(t=>t.studentId===e.userId);return 0===t&&(console.log("Debug - Students:",y.map(e=>({id:e.id,userId:e.userId,name:e.firstName}))),console.log("Debug - Attendance Records:",k.map(e=>({studentId:e.studentId,status:e.status}))),console.log("Debug - Looking for student userId:",e.userId),console.log("Debug - Found record:",s)),(0,a.jsxs)("tr",{className:"jsx-d104eb44e71cef75",children:[(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:t+1}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 fw-semibold",children:[e.firstName," ",e.lastName]})}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(0,a.jsx)("span",{className:"jsx-d104eb44e71cef75 badge bg-light text-dark",children:e.enrollmentNumber||"N/A"})}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:s?(0,a.jsxs)("span",{style:{width:"fit-content"},className:"jsx-d104eb44e71cef75 "+"badge bg-".concat(getStatusColor(s.status)," d-flex align-items-center gap-1"),children:[getStatusIcon(s.status),s.status.toUpperCase()]}):(0,a.jsx)("span",{className:"jsx-d104eb44e71cef75 badge bg-secondary",children:"Not Marked"})})]},e.id)})})]})})})]})})}),g&&(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 card border-0 shadow mb-4",children:[(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-header bg-white border-0 py-3",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 d-flex align-items-center justify-content-between",children:[(0,a.jsxs)("h5",{className:"jsx-d104eb44e71cef75 mb-0 fw-bold",children:[(0,a.jsx)(o.Z,{className:"me-2 text-primary",size:20}),"Attendance Calendar"]}),(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 d-flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>E("daily"),className:"jsx-d104eb44e71cef75 "+"btn btn-sm ".concat("daily"===D?"btn-primary":"btn-outline-primary"),children:"Daily View"}),(0,a.jsx)("button",{onClick:()=>E("monthly"),className:"jsx-d104eb44e71cef75 "+"btn btn-sm ".concat("monthly"===D?"btn-primary":"btn-outline-primary"),children:"Monthly View"})]})]})}),(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-body",children:(()=>{if("daily"===D)return(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsxs)("div",{className:"row g-3 mb-4",children:[(0,a.jsx)("div",{className:"col-12 col-md-6 col-lg-3",children:(0,a.jsx)("div",{className:"card border-0 shadow h-100",style:{background:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"},children:(0,a.jsxs)("div",{className:"card-body text-white",children:[(0,a.jsx)("h6",{className:"card-subtitle mb-2",children:"Attendance Rate"}),(0,a.jsxs)("h2",{className:"card-title display-4 fw-bold",children:[P.attendancePercentage,"%"]}),(0,a.jsxs)("p",{className:"card-text small",children:["For ",v]})]})})}),(0,a.jsx)("div",{className:"col-12 col-md-6 col-lg-3",children:(0,a.jsx)("div",{className:"card border-0 shadow h-100",style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},children:(0,a.jsxs)("div",{className:"card-body text-white",children:[(0,a.jsx)("h6",{className:"card-subtitle mb-2",children:"Present"}),(0,a.jsx)("h2",{className:"card-title display-4 fw-bold",children:P.present}),(0,a.jsxs)("p",{className:"card-text small",children:["Out of ",P.total," students"]})]})})}),(0,a.jsx)("div",{className:"col-12 col-md-6 col-lg-3",children:(0,a.jsx)("div",{className:"card border-0 shadow h-100",style:{background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)"},children:(0,a.jsxs)("div",{className:"card-body text-white",children:[(0,a.jsx)("h6",{className:"card-subtitle mb-2",children:"Absent"}),(0,a.jsx)("h2",{className:"card-title display-4 fw-bold",children:P.absent}),(0,a.jsxs)("p",{className:"card-text small",children:["Late: ",P.late]})]})})}),(0,a.jsx)("div",{className:"col-12 col-md-6 col-lg-3",children:(0,a.jsx)("div",{className:"card border-0 shadow h-100",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,a.jsxs)("div",{className:"card-body text-white",children:[(0,a.jsx)("h6",{className:"card-subtitle mb-2",children:"Excused"}),(0,a.jsx)("h2",{className:"card-title display-4 fw-bold",children:P.excused}),(0,a.jsx)("p",{className:"card-text small",children:"Medical/Leave"})]})})})]})});let e=new Date(M,I+1,0).getDate(),t=new Date(M,I,1).getDay(),s=[];for(let e=0;e<t;e++)s.push((0,a.jsx)("div",{className:"calendar-cell empty-cell"},"empty-".concat(e)));for(let t=1;t<=e;t++){let e="".concat(M,"-").concat(String(I+1).padStart(2,"0"),"-").concat(String(t).padStart(2,"0")),n=k.filter(t=>t.date.startsWith(e)),c=new Date().toDateString()===new Date(e).toDateString(),r=0===new Date(M,I,t).getDay(),l="",d="";if(n.length>0){let e=n.filter(e=>"present"===e.status).length,t=n.filter(e=>"absent"===e.status).length;n.filter(e=>"late"===e.status).length,n.filter(e=>"excused"===e.status).length;let s=y.length;e===s?(l="bg-success text-white",d="All Present"):t===s?(l="bg-danger text-white",d="All Absent"):(l=e>t?"bg-success bg-opacity-75 text-white":"bg-warning bg-opacity-75 text-dark",d="".concat(e,"/").concat(s))}else r?(l="bg-light text-muted",d="Sunday"):(l="bg-light text-muted",d="No Data");s.push((0,a.jsx)("div",{className:"calendar-cell ".concat(l," ").concat(c?"border border-primary border-3":""),style:{minHeight:"80px",padding:"8px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>{r||(w(e),E("daily"))},children:(0,a.jsxs)("div",{className:"d-flex flex-column h-100",children:[(0,a.jsx)("div",{className:"fw-bold mb-1",children:t}),(0,a.jsx)("div",{className:"small text-center flex-grow-1 d-flex align-items-center justify-content-center",children:d})]})},t))}return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,a.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>{0===I?(T(11),R(M-1)):T(I-1)},children:"← Previous"}),(0,a.jsxs)("h4",{className:"mb-0 fw-bold",children:[z[I]," ",M]}),(0,a.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>{11===I?(T(0),R(M+1)):T(I+1)},children:"Next →"})]}),(0,a.jsxs)("div",{className:"calendar-grid",style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px",marginBottom:"20px"},children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"text-center fw-bold text-muted py-2",children:e},e)),s]}),(0,a.jsxs)("div",{className:"d-flex flex-wrap gap-3 justify-content-center",children:[(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-success rounded",style:{width:"20px",height:"20px"}}),(0,a.jsx)("small",{children:"All Present"})]}),(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-success bg-opacity-75 rounded",style:{width:"20px",height:"20px"}}),(0,a.jsx)("small",{children:"Mostly Present"})]}),(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-warning bg-opacity-75 rounded",style:{width:"20px",height:"20px"}}),(0,a.jsx)("small",{children:"Low Attendance"})]}),(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-danger rounded",style:{width:"20px",height:"20px"}}),(0,a.jsx)("small",{children:"All Absent"})]}),(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-light rounded",style:{width:"20px",height:"20px"}}),(0,a.jsx)("small",{children:"No Data"})]}),(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{className:"bg-light text-muted rounded",style:{width:"20px",height:"20px"}}),(0,a.jsx)("small",{children:"Sunday (Holiday)"})]})]})]})})()})]}),"daily"===D&&(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 row",children:(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 col-12",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 card border-0 shadow",children:[(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-header bg-white border-0 py-3",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 d-flex justify-content-between align-items-center",children:[(0,a.jsxs)("h5",{className:"jsx-d104eb44e71cef75 mb-0 fw-bold",children:["Attendance for ",v,g&&" - ".concat(null===(t=u.find(e=>e.id===g))||void 0===t?void 0:t.name)]}),(0,a.jsxs)("span",{className:"jsx-d104eb44e71cef75 badge bg-primary",children:[k.length," / ",y.length," students"]})]})}),(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 card-body p-0",children:g?0===k.length?(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 text-center py-5 text-muted",children:[(0,a.jsx)(o.Z,{size:60,style:{opacity:.3}}),(0,a.jsx)("p",{className:"jsx-d104eb44e71cef75 mt-3",children:"No attendance records for this date"}),(0,a.jsx)("button",{onClick:handleMarkAttendance,className:"jsx-d104eb44e71cef75 btn btn-primary mt-2",children:"Mark Attendance Now"})]}):(0,a.jsx)("div",{className:"jsx-d104eb44e71cef75 table-responsive",children:(0,a.jsxs)("table",{className:"jsx-d104eb44e71cef75 table table-hover mb-0",children:[(0,a.jsx)("thead",{className:"jsx-d104eb44e71cef75 bg-light",children:(0,a.jsxs)("tr",{className:"jsx-d104eb44e71cef75",children:[(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Student Name"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Roll Number"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Status"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Mood"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Remarks"}),(0,a.jsx)("th",{className:"jsx-d104eb44e71cef75 border-0 py-3",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"jsx-d104eb44e71cef75",children:k.map(e=>{var t,s,n;return(0,a.jsxs)("tr",{className:"jsx-d104eb44e71cef75",children:[(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 fw-semibold",children:[null===(t=e.student)||void 0===t?void 0:t.firstName," ",null===(s=e.student)||void 0===s?void 0:s.lastName]})}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(null===(n=e.student)||void 0===n?void 0:n.enrollmentNumber)||"N/A"}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(0,a.jsxs)("span",{style:{width:"fit-content"},className:"jsx-d104eb44e71cef75 "+"badge bg-".concat(getStatusColor(e.status)," d-flex align-items-center gap-1"),children:[getStatusIcon(e.status),e.status.toUpperCase()]})}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:e.mood&&(0,a.jsx)("span",{className:"jsx-d104eb44e71cef75 badge bg-light text-dark",children:e.mood})}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(0,a.jsx)("span",{className:"jsx-d104eb44e71cef75 text-muted small",children:e.remarks||"-"})}),(0,a.jsx)("td",{className:"jsx-d104eb44e71cef75 py-3",children:(0,a.jsx)("button",{onClick:()=>handleDeleteRecord(e.id),className:"jsx-d104eb44e71cef75 btn btn-sm btn-outline-danger",children:(0,a.jsx)(x.Z,{size:16})})})]},e.id)})})]})}):(0,a.jsxs)("div",{className:"jsx-d104eb44e71cef75 text-center py-5 text-muted",children:[(0,a.jsx)(h.Z,{size:60,style:{opacity:.3}}),(0,a.jsx)("p",{className:"jsx-d104eb44e71cef75 mt-3",children:"Please select a class to view attendance"})]})})]})})})]}),(0,a.jsx)(c(),{id:"d104eb44e71cef75",children:".card.jsx-d104eb44e71cef75{-webkit-transition:-webkit-transform.2s ease,box-shadow.2s ease;-moz-transition:-moz-transform.2s ease,box-shadow.2s ease;-o-transition:-o-transform.2s ease,box-shadow.2s ease;transition:-webkit-transform.2s ease,box-shadow.2s ease;transition:-moz-transform.2s ease,box-shadow.2s ease;transition:-o-transform.2s ease,box-shadow.2s ease;transition:transform.2s ease,box-shadow.2s ease}.card.jsx-d104eb44e71cef75:hover{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 .5rem 1rem rgba(0,0,0,.15)!important;-moz-box-shadow:0 .5rem 1rem rgba(0,0,0,.15)!important;box-shadow:0 .5rem 1rem rgba(0,0,0,.15)!important}"})]})}},6454:function(e,t,s){"use strict";s.d(t,{CT:function(){return a},MS:function(){return ApiError},QW:function(){return apiDelete},R1:function(){return apiGet},Uh:function(){return clearAuthData},c7:function(){return storeUser},hV:function(){return getStoredToken},mB:function(){return storeToken},nc:function(){return apiPatch},pE:function(){return apiPut},sg:function(){return apiPost},vF:function(){return getStoredUser}});let a="http://localhost:3001";let ApiError=class ApiError extends Error{constructor(e,t,s){super(t),this.status=e,this.message=t,this.data=s,this.name="ApiError"}};async function apiRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:s,params:n,headers:c,...r}=t,l="".concat(a).concat(e);if(n){let e=new URLSearchParams(Object.entries(n).reduce((e,t)=>{let[s,a]=t;return null!=a&&(e[s]=String(a)),e},{})).toString();e&&(l+="?".concat(e))}let d={"Content-Type":"application/json",...c};s&&(d.Authorization="Bearer ".concat(s));try{let e=await fetch(l,{...r,headers:d}),t=await e.json().catch(()=>({}));if(!e.ok)throw new ApiError(e.status,t.message||"Request failed with status ".concat(e.status),t);return t}catch(e){if(e instanceof ApiError)throw e;throw new ApiError(0,e instanceof Error?e.message:"Network error occurred")}}async function apiGet(e,t){return apiRequest(e,{...t,method:"GET"})}async function apiPost(e,t,s){return apiRequest(e,{...s,method:"POST",body:t?JSON.stringify(t):void 0})}async function apiPut(e,t,s){return apiRequest(e,{...s,method:"PUT",body:t?JSON.stringify(t):void 0})}async function apiPatch(e,t,s){return apiRequest(e,{...s,method:"PATCH",body:t?JSON.stringify(t):void 0})}async function apiDelete(e,t){return apiRequest(e,{...t,method:"DELETE"})}function getStoredToken(){return localStorage.getItem("token")}function storeToken(e){localStorage.setItem("token",e)}function removeToken(){localStorage.removeItem("token")}function getStoredUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}function storeUser(e){localStorage.setItem("user",JSON.stringify(e))}function removeUser(){localStorage.removeItem("user")}function clearAuthData(){removeToken(),removeUser(),localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),localStorage.removeItem("userData")}},622:function(e,t,s){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=s(2265),n=Symbol.for("react.element"),c=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,s){var a,c={},i=null,o=null;for(a in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)r.call(t,a)&&!d.hasOwnProperty(a)&&(c[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===c[a]&&(c[a]=t[a]);return{$$typeof:n,type:e,key:i,ref:o,props:c,_owner:l.current}}t.Fragment=c,t.jsx=q,t.jsxs=q},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[9461,9738,2971,2472,1744],function(){return e(e.s=7935)}),_N_E=e.O()}]);