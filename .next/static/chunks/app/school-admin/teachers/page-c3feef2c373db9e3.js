(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4591],{2898:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var a=s(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:c,children:l,...o},d)=>(0,a.createElement)("svg",{ref:d,...n,width:r,height:r,stroke:s,strokeWidth:c?24*Number(i)/Number(r):i,className:`lucide lucide-${toKebabCase(e)}`,...o},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...(Array.isArray(l)?l:[l])||[]]));return s.displayName=`${e}`,s}},3067:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5817:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},9670:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2482:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},9617:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9883:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1827:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},5367:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5750:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2898);let n=(0,a.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},5390:function(e,t,s){Promise.resolve().then(s.bind(s,2901))},2901:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return TeachersPage}});var a=s(7437),n=s(2265),r=s(3067),i=s(5817),c=s(1827),l=s(2482),o=s(9883),d=s(5750),h=s(9670),u=s(9617),m=s(5367),x=s(1396),p=s.n(x),f=s(6454);function TeachersPage(){let[e,t]=(0,n.useState)([]),[s,x]=(0,n.useState)([]),[g,j]=(0,n.useState)(!0),[v,N]=(0,n.useState)(""),[b,y]=(0,n.useState)("all"),[w,k]=(0,n.useState)("all"),[C,S]=(0,n.useState)("name"),[Z,E]=(0,n.useState)("asc"),[L,A]=(0,n.useState)(1),[T]=(0,n.useState)(10),[P,M]=(0,n.useState)(1);(0,n.useEffect)(()=>{fetchTeachers()},[]),(0,n.useEffect)(()=>{let handleVisibilityChange=()=>{document.hidden||fetchTeachers()};return document.addEventListener("visibilitychange",handleVisibilityChange),()=>document.removeEventListener("visibilitychange",handleVisibilityChange)},[]);let fetchTeachers=async()=>{try{j(!0);let e=(0,f.hV)();if(!e){console.error("No authentication token found");return}let s=await (0,f.R1)("/teachers",{token:e});console.log("Teachers fetched:",s);let a=await Promise.all(s.map(async t=>{try{let s=await (0,f.R1)("/teachers/".concat(t.id,"/classes"),{token:e});return{...t,classes:s}}catch(e){return console.error("Error fetching classes for teacher ".concat(t.id,":"),e),{...t,classes:[]}}}));t(a),x(a)}catch(e){console.error("Error fetching teachers:",e),t([]),x([])}finally{j(!1)}};(0,n.useEffect)(()=>{let t=[...e];v&&(t=t.filter(e=>{var t,s,a;return"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(v.toLowerCase())||e.email.toLowerCase().includes(v.toLowerCase())||(null===(t=e.mobile)||void 0===t?void 0:t.toLowerCase().includes(v.toLowerCase()))||(null===(s=e.department)||void 0===s?void 0:s.toLowerCase().includes(v.toLowerCase()))||(null===(a=e.designation)||void 0===a?void 0:a.toLowerCase().includes(v.toLowerCase()))})),"all"!==b&&(t=t.filter(e=>e.status===b)),"all"!==w&&(t=t.filter(e=>e.department===w)),t.sort((e,t)=>{let s,a;switch(C){case"name":s="".concat(e.firstName," ").concat(e.lastName).toLowerCase(),a="".concat(t.firstName," ").concat(t.lastName).toLowerCase();break;case"email":s=e.email.toLowerCase(),a=t.email.toLowerCase();break;case"department":var n,r;s=(null===(n=e.department)||void 0===n?void 0:n.toLowerCase())||"",a=(null===(r=t.department)||void 0===r?void 0:r.toLowerCase())||"";break;case"experience":s=e.experienceYears||0,a=t.experienceYears||0;break;case"status":s=e.status.toLowerCase(),a=t.status.toLowerCase();break;default:s=e.firstName.toLowerCase(),a=t.firstName.toLowerCase()}return"asc"===Z?s<a?-1:s>a?1:0:s>a?-1:s<a?1:0}),x(t);let s=Math.ceil(t.length/T);M(s),L>s&&A(1)},[e,v,b,w,C,Z,L,T]);let handleDeleteTeacher=async e=>{if(confirm("⚠️ Are you sure you want to delete this teacher? This action cannot be undone."))try{let s=(0,f.hV)();if(!s){alert("Authentication required. Please login again.");return}await (0,f.QW)("/teachers/".concat(e),{token:s}),t(t=>t.filter(t=>t.id!==e)),alert("✅ Teacher deleted successfully!"),fetchTeachers()}catch(e){console.error("Error deleting teacher:",e),alert("❌ Error deleting teacher: ".concat((null==e?void 0:e.message)||"Please try again."))}},getInitials=(e,t)=>"".concat((null==e?void 0:e.charAt(0))||"").concat((null==t?void 0:t.charAt(0))||"").toUpperCase(),handlePageChange=e=>{A(e)},handleSort=e=>{C===e?E("asc"===Z?"desc":"asc"):(S(e),E("asc"))};return g?(0,a.jsx)("div",{className:"min-vh-100 bg-light d-flex align-items-center justify-content-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,a.jsx)("p",{className:"mt-3 text-muted",children:"Loading teachers..."})]})}):(0,a.jsxs)("div",{className:"min-vh-100 bg-light",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-bottom",children:(0,a.jsx)("div",{className:"container-fluid py-3",children:(0,a.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,a.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,a.jsx)(p(),{href:"/school-admin/dashboard",className:"btn btn-outline-secondary",children:(0,a.jsx)(r.Z,{size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"h3 mb-0 fw-bold text-dark",children:[(0,a.jsx)("i",{className:"fas fa-chalkboard-teacher me-2 text-primary"}),"Teachers Management"]}),(0,a.jsx)("p",{className:"text-muted mb-0",children:"Manage all teachers in your school"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{className:"btn btn-outline-secondary me-2",onClick:fetchTeachers,title:"Refresh teachers list",children:[(0,a.jsx)("i",{className:"fas fa-sync-alt me-2"}),"Refresh"]}),(0,a.jsxs)("button",{className:"btn btn-outline-primary me-2",title:"Export to CSV",children:[(0,a.jsx)(i.Z,{size:18,className:"me-2"}),"Export"]})]})]})})}),(0,a.jsxs)("div",{className:"container-fluid py-4",children:[(0,a.jsxs)("div",{className:"row g-3 mb-4",children:[(0,a.jsx)("div",{className:"col-md-4",children:(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("span",{className:"input-group-text bg-white border-end-0",children:(0,a.jsx)(c.Z,{size:18,className:"text-muted"})}),(0,a.jsx)("input",{type:"text",className:"form-control border-start-0",placeholder:"Search teachers by name, email, department...",value:v,onChange:e=>N(e.target.value)})]})}),(0,a.jsx)("div",{className:"col-md-2",children:(0,a.jsxs)("select",{className:"form-select",value:b,onChange:e=>y(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"}),(0,a.jsx)("option",{value:"resigned",children:"Resigned"}),(0,a.jsx)("option",{value:"retired",children:"Retired"}),(0,a.jsx)("option",{value:"suspended",children:"Suspended"})]})}),(0,a.jsx)("div",{className:"col-md-2",children:(0,a.jsxs)("select",{className:"form-select",value:w,onChange:e=>k(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Departments"}),(()=>{let t=e.map(e=>e.department).filter((e,t,s)=>e&&s.indexOf(e)===t).sort();return t})().map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),(0,a.jsx)("div",{className:"col-md-2",children:(0,a.jsxs)("select",{className:"form-select",value:"".concat(C,"-").concat(Z),onChange:e=>{let[t,s]=e.target.value.split("-");S(t),E(s)},children:[(0,a.jsx)("option",{value:"name-asc",children:"Name A-Z"}),(0,a.jsx)("option",{value:"name-desc",children:"Name Z-A"}),(0,a.jsx)("option",{value:"email-asc",children:"Email A-Z"}),(0,a.jsx)("option",{value:"email-desc",children:"Email Z-A"}),(0,a.jsx)("option",{value:"department-asc",children:"Department A-Z"}),(0,a.jsx)("option",{value:"department-desc",children:"Department Z-A"}),(0,a.jsx)("option",{value:"experience-desc",children:"Experience High-Low"}),(0,a.jsx)("option",{value:"experience-asc",children:"Experience Low-High"})]})}),(0,a.jsx)("div",{className:"col-md-2",children:(0,a.jsxs)("div",{className:"d-flex gap-2",children:[(0,a.jsx)("button",{className:"btn btn-outline-secondary flex-fill",onClick:()=>{N(""),y("all"),k("all"),S("name"),E("asc"),A(1)},title:"Clear all filters",children:(0,a.jsx)(l.Z,{size:16})}),(0,a.jsxs)(p(),{href:"/school-admin/add-teacher",className:"btn btn-primary flex-fill",children:[(0,a.jsx)(o.Z,{size:16,className:"me-1"}),"Add"]})]})})]}),(0,a.jsxs)("div",{className:"card border-0 shadow",children:[(0,a.jsx)("div",{className:"card-header bg-white border-0 py-3",children:(0,a.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,a.jsxs)("h5",{className:"mb-0 fw-bold text-dark",children:["Teachers List",(0,a.jsxs)("span",{className:"badge bg-primary ms-2",children:[s.length," teachers"]}),s.length!==e.length&&(0,a.jsxs)("span",{className:"badge bg-secondary ms-1",children:[e.length," total"]})]}),(0,a.jsxs)("div",{className:"text-muted small",children:["Showing ",Math.min((L-1)*T+1,s.length)," to ",Math.min(L*T,s.length)," of ",s.length," results",!1]})]})}),(0,a.jsx)("div",{className:"card-body p-0",children:0===s.length?(0,a.jsxs)("div",{className:"text-center py-5",children:[(0,a.jsx)(d.Z,{size:48,className:"text-muted mb-3"}),(0,a.jsx)("h5",{className:"text-muted",children:"No teachers found"}),(0,a.jsx)("p",{className:"text-muted",children:v||"all"!==b||"all"!==w?"Try adjusting your search or filters":"No teachers have been added yet"}),(0,a.jsxs)(p(),{href:"/school-admin/add-teacher",className:"btn btn-primary",children:[(0,a.jsx)(o.Z,{size:18,className:"me-2"}),"Add Teacher"]})]}):(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-hover mb-0",children:[(0,a.jsx)("thead",{className:"table-light",children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("name"),style:{cursor:"pointer"},children:["Teacher","name"===C&&(0,a.jsx)("i",{className:"fas fa-sort-".concat("asc"===Z?"up":"down"," ms-1")})]}),(0,a.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("email"),style:{cursor:"pointer"},children:["Contact","email"===C&&(0,a.jsx)("i",{className:"fas fa-sort-".concat("asc"===Z?"up":"down"," ms-1")})]}),(0,a.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("department"),style:{cursor:"pointer"},children:["Department","department"===C&&(0,a.jsx)("i",{className:"fas fa-sort-".concat("asc"===Z?"up":"down"," ms-1")})]}),(0,a.jsx)("th",{className:"border-0",children:"Assigned Classes"}),(0,a.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("experience"),style:{cursor:"pointer"},children:["Experience","experience"===C&&(0,a.jsx)("i",{className:"fas fa-sort-".concat("asc"===Z?"up":"down"," ms-1")})]}),(0,a.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("status"),style:{cursor:"pointer"},children:["Status","status"===C&&(0,a.jsx)("i",{className:"fas fa-sort-".concat("asc"===Z?"up":"down"," ms-1")})]}),(0,a.jsx)("th",{className:"border-0",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:(()=>{let e=(L-1)*T,t=e+T;return s.slice(e,t)})().map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)("div",{className:"bg-success bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"40px",height:"40px"},children:(0,a.jsx)("span",{className:"text-success fw-bold",children:getInitials(e.firstName,e.lastName)})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"fw-semibold",children:[e.firstName," ",e.lastName]}),(0,a.jsx)("small",{className:"text-muted",children:e.employeeId||"ID: ".concat(e.id)})]})]})}),(0,a.jsxs)("td",{children:[(0,a.jsx)("div",{className:"text-muted small",children:e.email}),(0,a.jsx)("small",{className:"text-muted",children:e.mobile||"No mobile"})]}),(0,a.jsx)("td",{children:e.department?(0,a.jsx)("span",{className:"badge bg-info",children:e.department}):(0,a.jsx)("span",{className:"text-muted small",children:"Not assigned"})}),(0,a.jsx)("td",{children:e.classes&&e.classes.length>0?(0,a.jsx)("div",{className:"d-flex flex-wrap gap-1",children:e.classes.map((e,t)=>(0,a.jsxs)("span",{className:"badge ".concat(e.isPrimary?"bg-primary":"bg-secondary"),title:e.isPrimary?"Primary Class":"Additional Class",children:[e.name,e.isPrimary&&" ⭐"]},t))}):(0,a.jsx)("span",{className:"text-muted small",children:"No classes assigned"})}),(0,a.jsx)("td",{children:e.experienceYears?(0,a.jsxs)("span",{className:"badge bg-warning text-dark",children:[e.experienceYears," years"]}):(0,a.jsx)("span",{className:"text-muted small",children:"N/A"})}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge ".concat("active"===e.status?"bg-success":"inactive"===e.status?"bg-secondary":"resigned"===e.status?"bg-info":"retired"===e.status?"bg-warning":"suspended"===e.status?"bg-danger":"bg-secondary"),children:e.status})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"btn-group",role:"group",children:[(0,a.jsx)(p(),{href:"/school-admin/teachers/".concat(e.id),className:"btn btn-sm btn-outline-primary",title:"View Details",children:(0,a.jsx)(h.Z,{size:16})}),(0,a.jsx)(p(),{href:"/school-admin/teachers/".concat(e.id,"/edit"),className:"btn btn-sm btn-outline-warning",title:"Edit",children:(0,a.jsx)(u.Z,{size:16})}),(0,a.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>handleDeleteTeacher(e.id),title:"Delete",children:(0,a.jsx)(m.Z,{size:16})})]})})]},e.id))})]})})})]}),s.length>T&&(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[(0,a.jsxs)("div",{className:"text-muted",children:["Showing ",Math.min((L-1)*T+1,s.length)," to ",Math.min(L*T,s.length)," of ",s.length," teachers"]}),(0,a.jsx)("nav",{"aria-label":"Teachers pagination",children:(0,a.jsxs)("ul",{className:"pagination pagination-sm mb-0",children:[(0,a.jsx)("li",{className:"page-item ".concat(1===L?"disabled":""),children:(0,a.jsx)("button",{className:"page-link",onClick:()=>handlePageChange(L-1),disabled:1===L,children:"Previous"})}),Array.from({length:Math.min(5,P)},(e,t)=>{let s;return s=P<=5?t+1:L<=3?t+1:L>=P-2?P-4+t:L-2+t,(0,a.jsx)("li",{className:"page-item ".concat(L===s?"active":""),children:(0,a.jsx)("button",{className:"page-link",onClick:()=>handlePageChange(s),children:s})},s)}),(0,a.jsx)("li",{className:"page-item ".concat(L===P?"disabled":""),children:(0,a.jsx)("button",{className:"page-link",onClick:()=>handlePageChange(L+1),disabled:L===P,children:"Next"})})]})})]})]})]})}},6454:function(e,t,s){"use strict";s.d(t,{CT:function(){return a},MS:function(){return ApiError},QW:function(){return apiDelete},R1:function(){return apiGet},Uh:function(){return clearAuthData},c7:function(){return storeUser},hV:function(){return getStoredToken},mB:function(){return storeToken},nc:function(){return apiPatch},pE:function(){return apiPut},sg:function(){return apiPost},vF:function(){return getStoredUser}});let a="http://localhost:3001";let ApiError=class ApiError extends Error{constructor(e,t,s){super(t),this.status=e,this.message=t,this.data=s,this.name="ApiError"}};async function apiRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:s,params:n,headers:r,...i}=t,c="".concat(a).concat(e);if(n){let e=new URLSearchParams(Object.entries(n).reduce((e,t)=>{let[s,a]=t;return null!=a&&(e[s]=String(a)),e},{})).toString();e&&(c+="?".concat(e))}let l={"Content-Type":"application/json",...r};s&&(l.Authorization="Bearer ".concat(s));try{let e=await fetch(c,{...i,headers:l}),t=await e.json().catch(()=>({}));if(!e.ok)throw new ApiError(e.status,t.message||"Request failed with status ".concat(e.status),t);return t}catch(e){if(e instanceof ApiError)throw e;throw new ApiError(0,e instanceof Error?e.message:"Network error occurred")}}async function apiGet(e,t){return apiRequest(e,{...t,method:"GET"})}async function apiPost(e,t,s){return apiRequest(e,{...s,method:"POST",body:t?JSON.stringify(t):void 0})}async function apiPut(e,t,s){return apiRequest(e,{...s,method:"PUT",body:t?JSON.stringify(t):void 0})}async function apiPatch(e,t,s){return apiRequest(e,{...s,method:"PATCH",body:t?JSON.stringify(t):void 0})}async function apiDelete(e,t){return apiRequest(e,{...t,method:"DELETE"})}function getStoredToken(){return localStorage.getItem("token")}function storeToken(e){localStorage.setItem("token",e)}function removeToken(){localStorage.removeItem("token")}function getStoredUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}function storeUser(e){localStorage.setItem("user",JSON.stringify(e))}function removeUser(){localStorage.removeItem("user")}function clearAuthData(){removeToken(),removeUser(),localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),localStorage.removeItem("userData")}}},function(e){e.O(0,[1176,2971,2472,1744],function(){return e(e.s=5390)}),_N_E=e.O()}]);