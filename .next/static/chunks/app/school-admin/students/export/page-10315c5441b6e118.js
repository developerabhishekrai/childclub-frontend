(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5043],{2898:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var r=s(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,t)=>{let s=(0,r.forwardRef)(({color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:c,children:o,...l},d)=>(0,r.createElement)("svg",{ref:d,...n,width:a,height:a,stroke:s,strokeWidth:c?24*Number(i)/Number(a):i,className:`lucide lucide-${toKebabCase(e)}`,...l},[...t.map(([e,t])=>(0,r.createElement)(e,t)),...(Array.isArray(o)?o:[o])||[]]));return s.displayName=`${e}`,s}},1981:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(2898);let n=(0,r.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3067:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(2898);let n=(0,r.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3008:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(2898);let n=(0,r.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5817:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(2898);let n=(0,r.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},6637:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(2898);let n=(0,r.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},5750:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(2898);let n=(0,r.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},3808:function(e,t,s){Promise.resolve().then(s.bind(s,6288))},6288:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ExportStudentsPage}});var r=s(7437),n=s(2265),a=s(3067),i=s(6637),c=s(5750),o=s(3008),l=s(1981),d=s(5817),u=s(1396),m=s.n(u),h=s(6454);function ExportStudentsPage(){let[e,t]=(0,n.useState)(!1),[s,u]=(0,n.useState)(0),[f,x]=(0,n.useState)("idle"),[p,y]=(0,n.useState)("");(0,n.useEffect)(()=>{fetchStudentCount()},[]);let fetchStudentCount=async()=>{try{let e=localStorage.getItem("token");if(!e)return;let t=await fetch("".concat(h.CT,"/students"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();u(e.length)}}catch(e){console.error("Error fetching student count:",e)}},handleExportCSV=async()=>{try{t(!0),x("idle"),y("");let e=localStorage.getItem("token");if(!e){y("Authentication required. Please login again."),x("error");return}let s=await fetch("".concat(h.CT,"/students/export/csv"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok)throw Error("Failed to export students");let r=await s.text(),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),i=URL.createObjectURL(n);a.setAttribute("href",i),a.setAttribute("download","students-export-".concat(new Date().toISOString().split("T")[0],".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),x("success")}catch(e){console.error("Error exporting students:",e),y(e instanceof Error?e.message:"Failed to export students"),x("error")}finally{t(!1)}};return(0,r.jsxs)("div",{className:"min-vh-100 bg-light",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-bottom",children:(0,r.jsx)("div",{className:"container-fluid py-3",children:(0,r.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,r.jsx)(m(),{href:"/school-admin/students",className:"btn btn-outline-secondary",children:(0,r.jsx)(a.Z,{size:20})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"h3 mb-0 fw-bold text-dark",children:[(0,r.jsx)("i",{className:"fas fa-download me-2 text-primary"}),"Export Students Data"]}),(0,r.jsx)("p",{className:"text-muted mb-0",children:"Download all student information in CSV format"})]})]})})}),(0,r.jsx)("div",{className:"container-fluid py-5",children:(0,r.jsx)("div",{className:"row justify-content-center",children:(0,r.jsxs)("div",{className:"col-md-8 col-lg-6",children:[(0,r.jsx)("div",{className:"card border-0 shadow-sm",children:(0,r.jsxs)("div",{className:"card-body p-5",children:[(0,r.jsxs)("div",{className:"text-center mb-4",children:[(0,r.jsx)("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"80px",height:"80px"},children:(0,r.jsx)(i.Z,{size:40,className:"text-primary"})}),(0,r.jsx)("h2",{className:"h4 fw-bold mb-2",children:"Export Student Data"}),(0,r.jsx)("p",{className:"text-muted",children:"Download a comprehensive CSV file containing all student information"})]}),(0,r.jsx)("div",{className:"bg-light rounded p-3 mb-4",children:(0,r.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,r.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,r.jsx)(c.Z,{size:20,className:"text-primary"}),(0,r.jsx)("span",{className:"fw-semibold",children:"Total Students"})]}),(0,r.jsx)("span",{className:"badge bg-primary fs-6",children:s})]})}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h5",{className:"fw-semibold mb-3",children:"Export includes:"}),(0,r.jsxs)("ul",{className:"list-unstyled",children:[(0,r.jsxs)("li",{className:"mb-2",children:[(0,r.jsx)("i",{className:"fas fa-check-circle text-success me-2"}),"Student personal information (Name, Email, Mobile)"]}),(0,r.jsxs)("li",{className:"mb-2",children:[(0,r.jsx)("i",{className:"fas fa-check-circle text-success me-2"}),"Student IDs (Roll Number, Admission Number)"]}),(0,r.jsxs)("li",{className:"mb-2",children:[(0,r.jsx)("i",{className:"fas fa-check-circle text-success me-2"}),"Parent/Guardian contact details"]}),(0,r.jsxs)("li",{className:"mb-2",children:[(0,r.jsx)("i",{className:"fas fa-check-circle text-success me-2"}),"Class and enrollment information"]}),(0,r.jsxs)("li",{className:"mb-2",children:[(0,r.jsx)("i",{className:"fas fa-check-circle text-success me-2"}),"Academic status and dates"]})]})]}),"success"===f&&(0,r.jsxs)("div",{className:"alert alert-success d-flex align-items-center",role:"alert",children:[(0,r.jsx)(o.Z,{size:20,className:"me-2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Success!"})," Student data has been exported successfully."]})]}),"error"===f&&(0,r.jsxs)("div",{className:"alert alert-danger d-flex align-items-center",role:"alert",children:[(0,r.jsx)(l.Z,{size:20,className:"me-2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Error!"})," ",p||"Failed to export student data."]})]}),(0,r.jsxs)("div",{className:"d-grid gap-2",children:[(0,r.jsx)("button",{className:"btn btn-primary btn-lg",onClick:handleExportCSV,disabled:e||0===s,children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Exporting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{size:20,className:"me-2"}),"Export to CSV"]})}),(0,r.jsx)(m(),{href:"/school-admin/students",className:"btn btn-outline-secondary",children:"Cancel"})]}),0===s&&(0,r.jsxs)("div",{className:"alert alert-warning mt-3 mb-0",role:"alert",children:[(0,r.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"No students found to export. Please add students first."]})]})}),(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsxs)("small",{className:"text-muted",children:[(0,r.jsx)("i",{className:"fas fa-info-circle me-1"}),"The exported CSV file can be opened in Microsoft Excel, Google Sheets, or any spreadsheet application."]})})]})})})]})}},6454:function(e,t,s){"use strict";s.d(t,{CT:function(){return r},MS:function(){return ApiError},QW:function(){return apiDelete},R1:function(){return apiGet},Uh:function(){return clearAuthData},c7:function(){return storeUser},hV:function(){return getStoredToken},mB:function(){return storeToken},nc:function(){return apiPatch},pE:function(){return apiPut},sg:function(){return apiPost},vF:function(){return getStoredUser}});let r="http://localhost:3001";let ApiError=class ApiError extends Error{constructor(e,t,s){super(t),this.status=e,this.message=t,this.data=s,this.name="ApiError"}};async function apiRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:s,params:n,headers:a,...i}=t,c="".concat(r).concat(e);if(n){let e=new URLSearchParams(Object.entries(n).reduce((e,t)=>{let[s,r]=t;return null!=r&&(e[s]=String(r)),e},{})).toString();e&&(c+="?".concat(e))}let o={"Content-Type":"application/json",...a};s&&(o.Authorization="Bearer ".concat(s));try{let e=await fetch(c,{...i,headers:o}),t=await e.json().catch(()=>({}));if(!e.ok)throw new ApiError(e.status,t.message||"Request failed with status ".concat(e.status),t);return t}catch(e){if(e instanceof ApiError)throw e;throw new ApiError(0,e instanceof Error?e.message:"Network error occurred")}}async function apiGet(e,t){return apiRequest(e,{...t,method:"GET"})}async function apiPost(e,t,s){return apiRequest(e,{...s,method:"POST",body:t?JSON.stringify(t):void 0})}async function apiPut(e,t,s){return apiRequest(e,{...s,method:"PUT",body:t?JSON.stringify(t):void 0})}async function apiPatch(e,t,s){return apiRequest(e,{...s,method:"PATCH",body:t?JSON.stringify(t):void 0})}async function apiDelete(e,t){return apiRequest(e,{...t,method:"DELETE"})}function getStoredToken(){return localStorage.getItem("token")}function storeToken(e){localStorage.setItem("token",e)}function removeToken(){localStorage.removeItem("token")}function getStoredUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null}function storeUser(e){localStorage.setItem("user",JSON.stringify(e))}function removeUser(){localStorage.removeItem("user")}function clearAuthData(){removeToken(),removeUser(),localStorage.removeItem("userRole"),localStorage.removeItem("userEmail"),localStorage.removeItem("userData")}}},function(e){e.O(0,[1176,2971,2472,1744],function(){return e(e.s=3808)}),_N_E=e.O()}]);