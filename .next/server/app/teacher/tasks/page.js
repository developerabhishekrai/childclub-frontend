(()=>{var e={};e.id=6609,e.ids=[6609],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},41539:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>c});var t=a(67096),l=a(16132),r=a(37284),i=a.n(r),n=a(32564),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(s,d);let c=["",{children:["teacher",{children:["tasks",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,19619)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\teacher\\tasks\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3539)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\teacher\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,79113)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\teacher\\tasks\\page.tsx"],m="/teacher/tasks/page",h={require:a,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/teacher/tasks/page",pathname:"/teacher/tasks",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},54529:(e,s,a)=>{Promise.resolve().then(a.bind(a,41721))},41721:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>TeacherTasksPage});var t=a(30784),l=a(9885),r=a(11440),i=a.n(r),n=a(79803),d=a(22385),c=a(69518),o=a(78937),m=a(517),h=a(28626),x=a(59494),g=a(26303),u=a(92032),j=a(91672),p=a(51831),b=a(19300),N=a(85525);function TeacherTasksPage(){let[e,s]=(0,l.useState)(""),[a,r]=(0,l.useState)("all"),[v,y]=(0,l.useState)("all"),[f,w]=(0,l.useState)("all"),[k,C]=(0,l.useState)([]),[S,D]=(0,l.useState)(!0),[T,A]=(0,l.useState)([]),[B,_]=(0,l.useState)([]),[z,P]=(0,l.useState)(null),[Z,$]=(0,l.useState)(null),[E,L]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("user")||"{}");P(e),fetchTasks(),fetchClasses(),fetchStudents()},[]);let fetchTasks=async()=>{try{let e=localStorage.getItem("token"),s=JSON.parse(localStorage.getItem("user")||"{}"),a=await fetch(`${N.CT}/assignments/my-teacher-assignments`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();console.log("Fetched teacher assignments:",e);let t=e.map(e=>({...e,creatorName:e.createdBy===s.id?"You":"School Admin",status:e.status||calculateStatus(e)}));C(t)}}catch(e){console.error("Error fetching tasks:",e),b.Z.fire("Error","Failed to fetch tasks","error")}finally{D(!1)}},fetchClasses=async()=>{try{let e=localStorage.getItem("token"),s=await fetch(`${N.CT}/classes`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){let e=await s.json();A(e)}}catch(e){console.error("Error fetching classes:",e)}},fetchStudents=async()=>{try{let e=localStorage.getItem("token"),s=await fetch(`${N.CT}/students`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){let e=await s.json();_(e)}}catch(e){console.error("Error fetching students:",e)}},calculateStatus=e=>{let s=new Date(e.dueDate),a=new Date;return s<a?"overdue":"pending"},getClassName=e=>{let s=T.find(s=>s.id===e);return s?.name||`Class ${s?.grade}-${s?.section}`||`Class ${e}`},getStudentName=e=>{let s=B.find(s=>s.id===e);return s?s.name?s.name:`${s.firstName} ${s.lastName}`:`Student ${e}`},q=k.filter(s=>{let t=s.title.toLowerCase().includes(e.toLowerCase())||s.description.toLowerCase().includes(e.toLowerCase()),l="all"===a||s.type.toLowerCase()===a.toLowerCase(),r="all"===v||s.priority.toLowerCase()===v.toLowerCase(),i="all"===f||"me"===f&&s.createdBy===z?.id||"admin"===f&&s.createdBy!==z?.id;return t&&l&&r&&i}),handleViewTask=e=>{$(e),L(!0)},handleDeleteTask=async(e,s)=>{if(s.createdBy!==z?.id){b.Z.fire("Not Allowed","You can only delete tasks created by you","warning");return}let a=await b.Z.fire({title:"Are you sure?",text:"Do you want to delete this task?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"});if(a.isConfirmed)try{let s=localStorage.getItem("token"),a=await fetch(`${N.CT}/assignments/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});a.ok?(b.Z.fire("Deleted!","Task has been deleted successfully","success"),fetchTasks()):b.Z.fire("Error","Failed to delete task","error")}catch(e){console.error("Error deleting task:",e),b.Z.fire("Error","Failed to delete task","error")}},getTypeBadge=e=>t.jsx("span",{className:`badge ${{assignment:"bg-primary",homework:"bg-success",project:"bg-info",quiz:"bg-warning",exam:"bg-danger"}[e.toLowerCase()]||"bg-secondary"}`,children:e}),getPriorityBadge=e=>t.jsx("span",{className:{low:"badge bg-secondary",medium:"badge bg-info",high:"badge bg-warning",urgent:"badge bg-danger"}[e.toLowerCase()]||"badge bg-secondary",children:e}),getStatusBadge=e=>t.jsx("span",{className:{pending:"badge bg-warning","in-progress":"badge bg-info",completed:"badge bg-success",overdue:"badge bg-danger"}[e]||"badge bg-secondary",children:e}),formatDate=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),getDaysUntilDue=e=>{let s=new Date,a=new Date(e),l=a.getTime()-s.getTime(),r=Math.ceil(l/864e5);return r<0?(0,t.jsxs)("span",{className:"text-danger fw-bold",children:["Overdue by ",Math.abs(r)," days"]}):0===r?t.jsx("span",{className:"text-warning fw-bold",children:"Due today"}):1===r?t.jsx("span",{className:"text-warning",children:"Due tomorrow"}):r<=3?(0,t.jsxs)("span",{className:"text-warning",children:["Due in ",r," days"]}):(0,t.jsxs)("span",{className:"text-muted",children:["Due in ",r," days"]})};return S?t.jsx("div",{className:"container-fluid",children:t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):(0,t.jsxs)("div",{className:"container-fluid",children:[(0,t.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,t.jsxs)("div",{className:"d-flex align-items-center",children:[t.jsx(i(),{href:"/teacher/dashboard",className:"btn btn-outline-secondary me-3",children:t.jsx(n.Z,{size:20})}),(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"h3 mb-0",children:"My Tasks & Assignments"}),t.jsx("p",{className:"text-muted mb-0",children:"View and manage assignments for your students"})]})]}),t.jsx("div",{className:"d-flex gap-2",children:(0,t.jsxs)(i(),{href:"/teacher/tasks/create",className:"btn btn-primary",children:[t.jsx(d.Z,{size:16,className:"me-2"}),"Create Assignment"]})})]}),t.jsx("div",{className:"card mb-4",children:t.jsx("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"row g-3",children:[t.jsx("div",{className:"col-md-3",children:(0,t.jsxs)("div",{className:"input-group",children:[t.jsx("span",{className:"input-group-text",children:t.jsx(c.Z,{size:16})}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Search tasks...",value:e,onChange:e=>s(e.target.value)})]})}),t.jsx("div",{className:"col-md-2",children:(0,t.jsxs)("select",{className:"form-select",value:a,onChange:e=>r(e.target.value),children:[t.jsx("option",{value:"all",children:"All Types"}),t.jsx("option",{value:"assignment",children:"Assignment"}),t.jsx("option",{value:"homework",children:"Homework"}),t.jsx("option",{value:"project",children:"Project"}),t.jsx("option",{value:"quiz",children:"Quiz"}),t.jsx("option",{value:"exam",children:"Exam"})]})}),t.jsx("div",{className:"col-md-2",children:(0,t.jsxs)("select",{className:"form-select",value:v,onChange:e=>y(e.target.value),children:[t.jsx("option",{value:"all",children:"All Priorities"}),t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"urgent",children:"Urgent"})]})}),t.jsx("div",{className:"col-md-3",children:(0,t.jsxs)("select",{className:"form-select",value:f,onChange:e=>w(e.target.value),children:[t.jsx("option",{value:"all",children:"All Assignments"}),t.jsx("option",{value:"me",children:"Created by Me"}),t.jsx("option",{value:"admin",children:"Created by School Admin"})]})})]})})}),(0,t.jsxs)("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:(0,t.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("h5",{className:"mb-0",children:"Assignments List"}),(0,t.jsxs)("span",{className:"badge bg-primary",children:[q.length," tasks"]})]})}),(0,t.jsxs)("div",{className:"card-body p-0",children:[t.jsx("div",{className:"table-responsive",children:(0,t.jsxs)("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{className:"table-light",children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"Task Details"}),t.jsx("th",{children:"Type & Priority"}),t.jsx("th",{children:"Due Date"}),t.jsx("th",{children:"Assigned To"}),t.jsx("th",{children:"Created By"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:q.map(e=>(0,t.jsxs)("tr",{children:[t.jsx("td",{children:(0,t.jsxs)("div",{className:"d-flex align-items-start",children:[t.jsx("div",{className:"avatar-sm bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-3",children:t.jsx(o.Z,{size:20,className:"text-primary"})}),(0,t.jsxs)("div",{className:"flex-grow-1",children:[t.jsx("div",{className:"fw-bold mb-1",children:e.title}),t.jsx("p",{className:"text-muted mb-2 small",children:e.description}),e.tags&&e.tags.length>0&&t.jsx("div",{className:"d-flex flex-wrap gap-1",children:e.tags.map((e,s)=>t.jsx("span",{className:"badge bg-light text-dark border small",children:e},s))})]})]})}),(0,t.jsxs)("td",{children:[t.jsx("div",{className:"mb-2",children:getTypeBadge(e.type)}),t.jsx("div",{className:"mb-2",children:getPriorityBadge(e.priority)}),t.jsx("div",{children:getStatusBadge(e.status||"pending")})]}),(0,t.jsxs)("td",{children:[(0,t.jsxs)("div",{className:"mb-2",children:[t.jsx(m.Z,{size:14,className:"me-1"}),formatDate(e.dueDate)]}),t.jsx("div",{children:getDaysUntilDue(e.dueDate)}),t.jsx("div",{className:"mt-2",children:(0,t.jsxs)("small",{className:"text-muted",children:["Max: ",e.maxScore," pts"]})})]}),(0,t.jsxs)("td",{children:[(0,t.jsxs)("div",{className:"mb-2",children:[t.jsx("strong",{children:"Classes:"}),t.jsx("div",{className:"d-flex flex-wrap gap-1 mt-1",children:e.assignedClasses&&e.assignedClasses.length>0?e.assignedClasses.map((e,s)=>t.jsx("span",{className:"badge bg-info small",children:getClassName(e)},s)):t.jsx("span",{className:"text-muted small",children:"None"})})]}),e.assignedStudents&&e.assignedStudents.length>0&&(0,t.jsxs)("div",{children:[t.jsx("strong",{children:"Students:"}),(0,t.jsxs)("div",{className:"d-flex flex-wrap gap-1 mt-1",children:[e.assignedStudents.slice(0,3).map((e,s)=>t.jsx("span",{className:"badge bg-warning small",children:getStudentName(e)},s)),e.assignedStudents.length>3&&(0,t.jsxs)("span",{className:"badge bg-warning small",children:["+",e.assignedStudents.length-3," more"]})]})]})]}),(0,t.jsxs)("td",{children:[t.jsx("div",{className:"mb-2",children:t.jsx("span",{className:`badge ${e.createdBy===z?.id?"bg-success":"bg-secondary"}`,children:e.creatorName})}),t.jsx("small",{className:"text-muted",children:formatDate(e.createdAt)})]}),t.jsx("td",{children:(0,t.jsxs)("div",{className:"btn-group",role:"group",children:[t.jsx("button",{className:"btn btn-sm btn-outline-primary",title:"View Details",onClick:()=>handleViewTask(e),children:t.jsx(h.Z,{size:14})}),t.jsx(i(),{href:`/teacher/tasks/edit/${e.id}`,className:"btn btn-sm btn-outline-warning",title:"Edit Task",children:t.jsx(x.Z,{size:14})}),e.createdBy===z?.id&&t.jsx("button",{className:"btn btn-sm btn-outline-danger",title:"Delete Task",onClick:()=>handleDeleteTask(e.id,e),children:t.jsx(g.Z,{size:14})})]})})]},e.id))})]})}),0===q.length&&(0,t.jsxs)("div",{className:"text-center py-5",children:[t.jsx("div",{className:"text-muted mb-3",children:t.jsx(c.Z,{size:48})}),t.jsx("h5",{children:"No tasks found"}),t.jsx("p",{className:"text-muted",children:"Try adjusting your filters or create a new assignment."}),(0,t.jsxs)(i(),{href:"/teacher/tasks/create",className:"btn btn-primary",children:[t.jsx(d.Z,{size:16,className:"me-2"}),"Create New Assignment"]})]})]})]}),(0,t.jsxs)("div",{className:"row g-4 mt-4",children:[t.jsx("div",{className:"col-md-3",children:t.jsx("div",{className:"card border-0 shadow-sm",children:(0,t.jsxs)("div",{className:"card-body text-center",children:[t.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle p-3 mx-auto mb-3",style:{width:"60px",height:"60px"},children:t.jsx(o.Z,{size:24,className:"text-primary"})}),t.jsx("h4",{className:"mb-1",children:k.length}),t.jsx("p",{className:"text-muted mb-0",children:"Total Tasks"})]})})}),t.jsx("div",{className:"col-md-3",children:t.jsx("div",{className:"card border-0 shadow-sm",children:(0,t.jsxs)("div",{className:"card-body text-center",children:[t.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle p-3 mx-auto mb-3",style:{width:"60px",height:"60px"},children:t.jsx(u.Z,{size:24,className:"text-success"})}),t.jsx("h4",{className:"mb-1",children:k.filter(e=>e.createdBy===z?.id).length}),t.jsx("p",{className:"text-muted mb-0",children:"Created by Me"})]})})}),t.jsx("div",{className:"col-md-3",children:t.jsx("div",{className:"card border-0 shadow-sm",children:(0,t.jsxs)("div",{className:"card-body text-center",children:[t.jsx("div",{className:"bg-secondary bg-opacity-10 rounded-circle p-3 mx-auto mb-3",style:{width:"60px",height:"60px"},children:t.jsx(j.Z,{size:24,className:"text-secondary"})}),t.jsx("h4",{className:"mb-1",children:k.filter(e=>e.createdBy!==z?.id).length}),t.jsx("p",{className:"text-muted mb-0",children:"From School Admin"})]})})}),t.jsx("div",{className:"col-md-3",children:t.jsx("div",{className:"card border-0 shadow-sm",children:(0,t.jsxs)("div",{className:"card-body text-center",children:[t.jsx("div",{className:"bg-danger bg-opacity-10 rounded-circle p-3 mx-auto mb-3",style:{width:"60px",height:"60px"},children:t.jsx(p.Z,{size:24,className:"text-danger"})}),t.jsx("h4",{className:"mb-1",children:q.filter(e=>"overdue"===e.status).length}),t.jsx("p",{className:"text-muted mb-0",children:"Overdue"})]})})})]}),E&&Z&&t.jsx("div",{className:"modal show d-block",tabIndex:-1,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:t.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header bg-primary text-white",children:[(0,t.jsxs)("h5",{className:"modal-title",children:[t.jsx(h.Z,{size:20,className:"me-2"}),"Task Details"]}),t.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:()=>L(!1)})]}),t.jsx("div",{className:"modal-body",children:(0,t.jsxs)("div",{className:"row g-4",children:[(0,t.jsxs)("div",{className:"col-12",children:[t.jsx("h4",{className:"text-primary",children:Z.title}),(0,t.jsxs)("div",{className:"d-flex gap-2 mb-3",children:[getTypeBadge(Z.type),getPriorityBadge(Z.priority),getStatusBadge(Z.status||"pending"),t.jsx("span",{className:`badge ${Z.createdBy===z?.id?"bg-success":"bg-secondary"}`,children:Z.creatorName})]})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[t.jsx("label",{className:"text-muted small",children:"Description"}),t.jsx("p",{children:Z.description})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[t.jsx("label",{className:"text-muted small",children:"Due Date"}),(0,t.jsxs)("p",{children:[t.jsx(m.Z,{size:16,className:"me-2"}),formatDate(Z.dueDate)]}),t.jsx("div",{children:getDaysUntilDue(Z.dueDate)})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[t.jsx("label",{className:"text-muted small",children:"Max Score"}),(0,t.jsxs)("p",{className:"fw-bold",children:[Z.maxScore," points"]})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[t.jsx("label",{className:"text-muted small",children:"Created Date"}),t.jsx("p",{children:formatDate(Z.createdAt)})]}),Z.instructions&&(0,t.jsxs)("div",{className:"col-12",children:[t.jsx("label",{className:"text-muted small",children:"Instructions"}),t.jsx("div",{className:"p-3 bg-light rounded",children:t.jsx("p",{className:"mb-0",children:Z.instructions})})]}),Z.rubric&&(0,t.jsxs)("div",{className:"col-12",children:[t.jsx("label",{className:"text-muted small",children:"Grading Rubric"}),t.jsx("div",{className:"p-3 bg-light rounded",children:t.jsx("p",{className:"mb-0",children:Z.rubric})})]}),(0,t.jsxs)("div",{className:"col-12",children:[t.jsx("label",{className:"text-muted small",children:"Assigned To"}),(0,t.jsxs)("div",{className:"row g-3",children:[(0,t.jsxs)("div",{className:"col-md-6",children:[t.jsx("strong",{children:"Classes:"}),t.jsx("div",{className:"d-flex flex-wrap gap-1 mt-2",children:Z.assignedClasses&&Z.assignedClasses.length>0?Z.assignedClasses.map((e,s)=>t.jsx("span",{className:"badge bg-info",children:getClassName(e)},s)):t.jsx("span",{className:"text-muted small",children:"None"})})]}),(0,t.jsxs)("div",{className:"col-md-6",children:[t.jsx("strong",{children:"Students:"}),t.jsx("div",{className:"d-flex flex-wrap gap-1 mt-2",children:Z.assignedStudents&&Z.assignedStudents.length>0?Z.assignedStudents.map((e,s)=>t.jsx("span",{className:"badge bg-warning",children:getStudentName(e)},s)):t.jsx("span",{className:"text-muted small",children:"None"})})]})]})]}),Z.tags&&Z.tags.length>0&&(0,t.jsxs)("div",{className:"col-12",children:[t.jsx("label",{className:"text-muted small",children:"Tags"}),t.jsx("div",{className:"d-flex flex-wrap gap-2",children:Z.tags.map((e,s)=>t.jsx("span",{className:"badge bg-secondary",children:e},s))})]})]})}),(0,t.jsxs)("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>L(!1),children:"Close"}),(0,t.jsxs)(i(),{href:`/teacher/tasks/edit/${Z.id}`,className:"btn btn-warning",children:[t.jsx(x.Z,{size:16,className:"me-2"}),"Edit Task"]})]})]})})})]})}},19619:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>d});var t=a(95153);let l=(0,t.createProxy)(String.raw`C:\xampp\htdocs\childclub\childclub-frontend\src\app\teacher\tasks\page.tsx`),{__esModule:r,$$typeof:i}=l,n=l.default,d=n}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[659,1336,9675,3528,9300,950,4028,656,5525,4133],()=>__webpack_exec__(41539));module.exports=a})();