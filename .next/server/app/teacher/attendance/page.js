(()=>{var e={};e.id=9018,e.ids=[9018],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},92556:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>r.a,__next_app__:()=>x,originalPathname:()=>f,pages:()=>o,routeModule:()=>m,tree:()=>i});var t=a(67096),d=a(16132),c=a(37284),r=a.n(c),l=a(32564),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);a.d(s,n);let i=["",{children:["teacher",{children:["attendance",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,32367)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\teacher\\attendance\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3539)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\teacher\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,79113)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\teacher\\attendance\\page.tsx"],f="/teacher/attendance/page",x={require:a,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:d.x.APP_PAGE,page:"/teacher/attendance/page",pathname:"/teacher/attendance",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},48193:(e,s,a)=>{Promise.resolve().then(a.bind(a,94665))},94665:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>TeacherAttendancePage});var t=a(30784),d=a(23745),c=a.n(d),r=a(9885),l=a(11440),n=a.n(l),i=a(79803),o=a(517),f=a(92032),x=a(81057),m=a(15441),b=a(51831),h=a(91672),j=a(52995),u=a(19300),p=a(85525);function TeacherAttendancePage(){let[e,s]=(0,r.useState)([]),[a,d]=(0,r.useState)(null),[l,N]=(0,r.useState)([]),[g,v]=(0,r.useState)(new Date().toISOString().split("T")[0]),[y,w]=(0,r.useState)(new Map),[k,A]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{fetchTeacherClasses()},[]),(0,r.useEffect)(()=>{a&&(fetchClassStudents(a),fetchExistingAttendance(a,g))},[a,g]);let fetchTeacherClasses=async()=>{try{A(!0);let e=localStorage.getItem("token"),a=localStorage.getItem("userId"),t=await fetch(`${p.CT}/teachers/user/${a}/classes`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();s(e)}else{let a=await fetch(`${p.CT}/classes`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();s(e)}}}catch(e){console.error("Error fetching classes:",e),u.Z.fire({icon:"error",title:"Error",text:"Failed to load classes"})}finally{A(!1)}},fetchClassStudents=async e=>{try{A(!0);let s=localStorage.getItem("token"),a=await fetch(`${p.CT}/students/class/${e}`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){let s=await a.json();console.log("Fetched students for teacher class:",e,"Count:",s.length),N(s);let t=new Map;s.forEach(e=>{t.set(e.userId,{studentId:e.userId,status:"present"})}),w(t)}}catch(e){console.error("Error fetching students:",e)}finally{A(!1)}},fetchExistingAttendance=async(e,s)=>{try{let a=localStorage.getItem("token"),t=await fetch(`${p.CT}/attendance/class/${e}?date=${s}`,{headers:{Authorization:`Bearer ${a}`}});if(t.ok){let e=await t.json();if(e.length>0){let s=new Map;e.forEach(e=>{s.set(e.studentId,{studentId:e.studentId,status:e.status,remarks:e.remarks,mood:e.mood})}),w(s)}}}catch(e){console.error("Error fetching attendance:",e)}},updateAttendance=(e,s,a)=>{w(t=>{let d=new Map(t),c=d.get(e)||{studentId:e,status:"present",mood:"",remarks:""};return d.set(e,{...c,[s]:a}),d})},markAllAs=e=>{w(s=>{let a=new Map(s);return l.forEach(s=>{let t=s.userId,d=a.get(t)||{studentId:t,status:"present",mood:"",remarks:""};a.set(t,{...d,status:e})}),a})},handleSubmit=async()=>{if(!a){u.Z.fire({icon:"warning",title:"Warning",text:"Please select a class"});return}let e=await u.Z.fire({title:"Submit Attendance?",text:`Marking attendance for ${l.length} students on ${g}`,icon:"question",showCancelButton:!0,confirmButtonText:"Yes, submit",cancelButtonText:"Cancel"});if(e.isConfirmed){S(!0);try{let e=localStorage.getItem("token"),s=Array.from(y.values()),t={classId:a,date:g,attendance:s};console.log("Teacher submitting attendance:",t);let d=await fetch(`${p.CT}/attendance`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)}),c=await d.json();if(console.log("Attendance response:",c),d.ok)u.Z.fire({icon:"success",title:"Success!",text:"Attendance marked successfully",timer:2e3,showConfirmButton:!1}),fetchExistingAttendance(a,g);else throw Error(c.message||"Failed to mark attendance")}catch(e){console.error("Error marking attendance:",e),u.Z.fire({icon:"error",title:"Error",text:e.message||"Failed to mark attendance. Please try again."})}finally{S(!1)}}},E=(()=>{let e={present:0,absent:0,late:0,excused:0};return y.forEach(s=>{e[s.status]++}),e})();return(0,t.jsxs)("div",{style:{background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh"},className:"jsx-f1e16b29cd989d1f",children:[(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f container-fluid p-4",children:[t.jsx("div",{className:"jsx-f1e16b29cd989d1f row mb-4",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-12",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow-lg bg-primary",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-white p-4",children:[(0,t.jsxs)(n(),{href:"/teacher/dashboard",className:"btn btn-light btn-sm mb-3",children:[t.jsx(i.Z,{size:16,className:"me-2"}),"Back to Dashboard"]}),(0,t.jsxs)("h1",{className:"jsx-f1e16b29cd989d1f display-5 fw-bold mb-2",children:[t.jsx(o.Z,{size:50,className:"me-3"}),"Mark Attendance"]}),t.jsx("p",{className:"jsx-f1e16b29cd989d1f mb-0 opacity-75",children:"Record daily attendance for your class"})]})})})}),t.jsx("div",{className:"jsx-f1e16b29cd989d1f row mb-4",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-12",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body",children:[(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f row g-3",children:[(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f col-12 col-md-6",children:[t.jsx("label",{className:"jsx-f1e16b29cd989d1f form-label fw-semibold",children:"Select Class"}),(0,t.jsxs)("select",{value:a||"",onChange:e=>d(Number(e.target.value)),className:"jsx-f1e16b29cd989d1f form-select form-select-lg",children:[t.jsx("option",{value:"",className:"jsx-f1e16b29cd989d1f",children:"Choose a class..."}),e.map(e=>t.jsx("option",{value:e.id,className:"jsx-f1e16b29cd989d1f",children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f col-12 col-md-6",children:[t.jsx("label",{className:"jsx-f1e16b29cd989d1f form-label fw-semibold",children:"Date"}),t.jsx("input",{type:"date",value:g,onChange:e=>v(e.target.value),className:"jsx-f1e16b29cd989d1f form-control form-control-lg"})]})]}),a&&l.length>0&&(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f mt-4",children:[t.jsx("label",{className:"jsx-f1e16b29cd989d1f form-label fw-semibold",children:"Quick Actions"}),(0,t.jsxs)("div",{role:"group",className:"jsx-f1e16b29cd989d1f btn-group w-100",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>markAllAs("present"),className:"jsx-f1e16b29cd989d1f btn btn-outline-success",children:[t.jsx(f.Z,{size:18,className:"me-2"}),"Mark All Present"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>markAllAs("absent"),className:"jsx-f1e16b29cd989d1f btn btn-outline-danger",children:[t.jsx(x.Z,{size:18,className:"me-2"}),"Mark All Absent"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>markAllAs("late"),className:"jsx-f1e16b29cd989d1f btn btn-outline-warning",children:[t.jsx(m.Z,{size:18,className:"me-2"}),"Mark All Late"]})]})]})]})})})}),a&&l.length>0&&(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f row g-3 mb-4",children:[t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-6 col-md-3",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow h-100 bg-success text-white",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-center",children:[t.jsx(f.Z,{size:30,className:"mb-2"}),t.jsx("h3",{className:"jsx-f1e16b29cd989d1f mb-0",children:E.present}),t.jsx("small",{className:"jsx-f1e16b29cd989d1f",children:"Present"})]})})}),t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-6 col-md-3",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow h-100 bg-danger text-white",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-center",children:[t.jsx(x.Z,{size:30,className:"mb-2"}),t.jsx("h3",{className:"jsx-f1e16b29cd989d1f mb-0",children:E.absent}),t.jsx("small",{className:"jsx-f1e16b29cd989d1f",children:"Absent"})]})})}),t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-6 col-md-3",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow h-100 bg-warning text-white",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-center",children:[t.jsx(m.Z,{size:30,className:"mb-2"}),t.jsx("h3",{className:"jsx-f1e16b29cd989d1f mb-0",children:E.late}),t.jsx("small",{className:"jsx-f1e16b29cd989d1f",children:"Late"})]})})}),t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-6 col-md-3",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow h-100 bg-info text-white",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-center",children:[t.jsx(b.Z,{size:30,className:"mb-2"}),t.jsx("h3",{className:"jsx-f1e16b29cd989d1f mb-0",children:E.excused}),t.jsx("small",{className:"jsx-f1e16b29cd989d1f",children:"Excused"})]})})})]}),a&&l.length>0&&t.jsx("div",{className:"jsx-f1e16b29cd989d1f row",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-12",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow",children:[t.jsx("div",{className:"jsx-f1e16b29cd989d1f card-header bg-white border-0 py-3",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f d-flex justify-content-between align-items-center",children:[(0,t.jsxs)("h5",{className:"jsx-f1e16b29cd989d1f mb-0 fw-bold",children:[t.jsx(h.Z,{size:20,className:"me-2"}),"Student List (",l.length," students)"]}),(0,t.jsxs)("button",{onClick:handleSubmit,disabled:C,className:"jsx-f1e16b29cd989d1f btn btn-primary",children:[t.jsx(j.Z,{size:18,className:"me-2"}),C?"Saving...":"Save Attendance"]})]})}),t.jsx("div",{className:"jsx-f1e16b29cd989d1f card-body p-0",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f table-responsive",children:(0,t.jsxs)("table",{className:"jsx-f1e16b29cd989d1f table table-hover mb-0",children:[t.jsx("thead",{className:"jsx-f1e16b29cd989d1f bg-light",children:(0,t.jsxs)("tr",{className:"jsx-f1e16b29cd989d1f",children:[t.jsx("th",{className:"jsx-f1e16b29cd989d1f border-0 py-3",children:"Roll No"}),t.jsx("th",{className:"jsx-f1e16b29cd989d1f border-0 py-3",children:"Student Name"}),t.jsx("th",{className:"jsx-f1e16b29cd989d1f border-0 py-3",children:"Status"}),t.jsx("th",{className:"jsx-f1e16b29cd989d1f border-0 py-3",children:"Mood"}),t.jsx("th",{className:"jsx-f1e16b29cd989d1f border-0 py-3",children:"Remarks"})]})}),t.jsx("tbody",{className:"jsx-f1e16b29cd989d1f",children:l.map(e=>{let s=e.userId,a=y.get(s)||{studentId:s,status:"present",mood:"",remarks:""};return(0,t.jsxs)("tr",{className:"jsx-f1e16b29cd989d1f",children:[t.jsx("td",{className:"jsx-f1e16b29cd989d1f py-3 align-middle",children:t.jsx("span",{className:"jsx-f1e16b29cd989d1f badge bg-secondary",children:e.enrollmentNumber||"N/A"})}),t.jsx("td",{className:"jsx-f1e16b29cd989d1f py-3 align-middle",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f fw-semibold",children:[e.firstName," ",e.lastName]})}),t.jsx("td",{className:"jsx-f1e16b29cd989d1f py-3 align-middle",children:(0,t.jsxs)("select",{value:a.status,onChange:e=>updateAttendance(s,"status",e.target.value),style:{minWidth:"120px"},className:`jsx-f1e16b29cd989d1f form-select form-select-sm w-auto bg-${"present"===a.status?"success":"absent"===a.status?"danger":"late"===a.status?"warning":"info"} text-white border-0`,children:[t.jsx("option",{value:"present",className:"jsx-f1e16b29cd989d1f",children:"✓ Present"}),t.jsx("option",{value:"absent",className:"jsx-f1e16b29cd989d1f",children:"✗ Absent"}),t.jsx("option",{value:"late",className:"jsx-f1e16b29cd989d1f",children:"⏰ Late"}),t.jsx("option",{value:"excused",className:"jsx-f1e16b29cd989d1f",children:"\uD83D\uDCCB Excused"})]})}),t.jsx("td",{className:"jsx-f1e16b29cd989d1f py-3 align-middle",children:(0,t.jsxs)("select",{value:a.mood||"",onChange:e=>updateAttendance(s,"mood",e.target.value),style:{minWidth:"140px"},className:"jsx-f1e16b29cd989d1f form-select form-select-sm w-auto",children:[t.jsx("option",{value:"",className:"jsx-f1e16b29cd989d1f",children:"Select mood..."}),t.jsx("option",{value:"happy",className:"jsx-f1e16b29cd989d1f",children:"\uD83D\uDE0A Happy"}),t.jsx("option",{value:"sad",className:"jsx-f1e16b29cd989d1f",children:"\uD83D\uDE22 Sad"}),t.jsx("option",{value:"sick",className:"jsx-f1e16b29cd989d1f",children:"\uD83E\uDD12 Sick"}),t.jsx("option",{value:"energetic",className:"jsx-f1e16b29cd989d1f",children:"⚡ Energetic"}),t.jsx("option",{value:"tired",className:"jsx-f1e16b29cd989d1f",children:"\uD83D\uDE34 Tired"})]})}),t.jsx("td",{className:"jsx-f1e16b29cd989d1f py-3 align-middle",children:t.jsx("input",{type:"text",value:a.remarks||"",onChange:e=>updateAttendance(s,"remarks",e.target.value),placeholder:"Add remarks...",className:"jsx-f1e16b29cd989d1f form-control form-control-sm"})})]},e.id)})})]})})}),t.jsx("div",{className:"jsx-f1e16b29cd989d1f card-footer bg-white border-0 py-3",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f d-flex justify-content-between align-items-center",children:[t.jsx("div",{className:"jsx-f1e16b29cd989d1f text-muted",children:(0,t.jsxs)("small",{className:"jsx-f1e16b29cd989d1f",children:["Total: ",l.length," students"]})}),(0,t.jsxs)("button",{onClick:handleSubmit,disabled:C,className:"jsx-f1e16b29cd989d1f btn btn-primary btn-lg",children:[t.jsx(j.Z,{size:20,className:"me-2"}),C?"Saving...":"Save Attendance"]})]})})]})})}),a&&0===l.length&&!k&&t.jsx("div",{className:"jsx-f1e16b29cd989d1f row",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-12",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-center py-5",children:[t.jsx(h.Z,{size:60,style:{opacity:.3},className:"text-muted mb-3"}),t.jsx("h5",{className:"jsx-f1e16b29cd989d1f text-muted",children:"No students found in this class"}),t.jsx("p",{className:"jsx-f1e16b29cd989d1f text-muted",children:"Please select a different class or add students first."})]})})})}),!a&&t.jsx("div",{className:"jsx-f1e16b29cd989d1f row",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f col-12",children:t.jsx("div",{className:"jsx-f1e16b29cd989d1f card border-0 shadow",children:(0,t.jsxs)("div",{className:"jsx-f1e16b29cd989d1f card-body text-center py-5",children:[t.jsx(o.Z,{size:60,style:{opacity:.3},className:"text-muted mb-3"}),t.jsx("h5",{className:"jsx-f1e16b29cd989d1f text-muted",children:"Select a class to mark attendance"}),t.jsx("p",{className:"jsx-f1e16b29cd989d1f text-muted",children:"Choose a class from the dropdown above to get started."})]})})})})]}),t.jsx(c(),{id:"f1e16b29cd989d1f",children:".card.jsx-f1e16b29cd989d1f{-webkit-transition:-webkit-transform.2s ease,box-shadow.2s ease;-moz-transition:-moz-transform.2s ease,box-shadow.2s ease;-o-transition:-o-transform.2s ease,box-shadow.2s ease;transition:-webkit-transform.2s ease,box-shadow.2s ease;transition:-moz-transform.2s ease,box-shadow.2s ease;transition:-o-transform.2s ease,box-shadow.2s ease;transition:transform.2s ease,box-shadow.2s ease}.table.jsx-f1e16b29cd989d1f tbody.jsx-f1e16b29cd989d1f tr.jsx-f1e16b29cd989d1f{-webkit-transition:background-color.2s ease;-moz-transition:background-color.2s ease;-o-transition:background-color.2s ease;transition:background-color.2s ease}.table.jsx-f1e16b29cd989d1f tbody.jsx-f1e16b29cd989d1f tr.jsx-f1e16b29cd989d1f:hover{background-color:#f8f9fa}"})]})}},32367:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>r,__esModule:()=>c,default:()=>n});var t=a(95153);let d=(0,t.createProxy)(String.raw`C:\xampp\htdocs\childclub\childclub-frontend\src\app\teacher\attendance\page.tsx`),{__esModule:c,$$typeof:r}=d,l=d.default,n=l}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[659,1336,9675,3528,9300,1812,1990,656,5525,4133],()=>__webpack_exec__(92556));module.exports=a})();