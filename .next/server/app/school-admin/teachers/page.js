(()=>{var e={};e.id=4591,e.ids=[4591],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},96789:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>o,routeModule:()=>x,tree:()=>d});var t=a(67096),l=a(16132),r=a(37284),n=a.n(r),i=a(32564),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);a.d(s,c);let d=["",{children:["school-admin",{children:["teachers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,13326)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\school-admin\\teachers\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,25803)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\school-admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,79113)),"C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\xampp\\htdocs\\childclub\\childclub-frontend\\src\\app\\school-admin\\teachers\\page.tsx"],h="/school-admin/teachers/page",m={require:a,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/school-admin/teachers/page",pathname:"/school-admin/teachers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},20037:(e,s,a)=>{Promise.resolve().then(a.bind(a,75699))},75699:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>TeachersPage});var t=a(30784),l=a(9885),r=a(79803),n=a(85574),i=a(69518),c=a(12029),d=a(22385),o=a(91672),h=a(28626),m=a(59494),x=a(26303),u=a(11440),p=a.n(u),g=a(85525);function TeachersPage(){let[e,s]=(0,l.useState)([]),[a,u]=(0,l.useState)([]),[j,b]=(0,l.useState)(!0),[N,f]=(0,l.useState)(""),[v,y]=(0,l.useState)("all"),[w,C]=(0,l.useState)("all"),[P,k]=(0,l.useState)("name"),[$,L]=(0,l.useState)("asc"),[_,S]=(0,l.useState)(1),[A]=(0,l.useState)(10),[E,T]=(0,l.useState)(1);(0,l.useEffect)(()=>{fetchTeachers()},[]),(0,l.useEffect)(()=>{let handleVisibilityChange=()=>{document.hidden||fetchTeachers()};return document.addEventListener("visibilitychange",handleVisibilityChange),()=>document.removeEventListener("visibilitychange",handleVisibilityChange)},[]);let fetchTeachers=async()=>{try{b(!0);let e=(0,g.hV)();if(!e){console.error("No authentication token found");return}let a=await (0,g.R1)("/teachers",{token:e});console.log("Teachers fetched:",a);let t=await Promise.all(a.map(async s=>{try{let a=await (0,g.R1)(`/teachers/${s.id}/classes`,{token:e});return{...s,classes:a}}catch(e){return console.error(`Error fetching classes for teacher ${s.id}:`,e),{...s,classes:[]}}}));s(t),u(t)}catch(e){console.error("Error fetching teachers:",e),s([]),u([])}finally{b(!1)}};(0,l.useEffect)(()=>{let s=[...e];N&&(s=s.filter(e=>`${e.firstName} ${e.lastName}`.toLowerCase().includes(N.toLowerCase())||e.email.toLowerCase().includes(N.toLowerCase())||e.mobile?.toLowerCase().includes(N.toLowerCase())||e.department?.toLowerCase().includes(N.toLowerCase())||e.designation?.toLowerCase().includes(N.toLowerCase()))),"all"!==v&&(s=s.filter(e=>e.status===v)),"all"!==w&&(s=s.filter(e=>e.department===w)),s.sort((e,s)=>{let a,t;switch(P){case"name":a=`${e.firstName} ${e.lastName}`.toLowerCase(),t=`${s.firstName} ${s.lastName}`.toLowerCase();break;case"email":a=e.email.toLowerCase(),t=s.email.toLowerCase();break;case"department":a=e.department?.toLowerCase()||"",t=s.department?.toLowerCase()||"";break;case"experience":a=e.experienceYears||0,t=s.experienceYears||0;break;case"status":a=e.status.toLowerCase(),t=s.status.toLowerCase();break;default:a=e.firstName.toLowerCase(),t=s.firstName.toLowerCase()}return"asc"===$?a<t?-1:a>t?1:0:a>t?-1:a<t?1:0}),u(s);let a=Math.ceil(s.length/A);T(a),_>a&&S(1)},[e,N,v,w,P,$,_,A]);let handleDeleteTeacher=async e=>{if(confirm("⚠️ Are you sure you want to delete this teacher? This action cannot be undone."))try{let a=(0,g.hV)();if(!a){alert("Authentication required. Please login again.");return}await (0,g.QW)(`/teachers/${e}`,{token:a}),s(s=>s.filter(s=>s.id!==e)),alert("✅ Teacher deleted successfully!"),fetchTeachers()}catch(e){console.error("Error deleting teacher:",e),alert(`❌ Error deleting teacher: ${e?.message||"Please try again."}`)}},getInitials=(e,s)=>`${e?.charAt(0)||""}${s?.charAt(0)||""}`.toUpperCase(),handlePageChange=e=>{S(e)},handleSort=e=>{P===e?L("asc"===$?"desc":"asc"):(k(e),L("asc"))};return j?t.jsx("div",{className:"min-vh-100 bg-light d-flex align-items-center justify-content-center",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("p",{className:"mt-3 text-muted",children:"Loading teachers..."})]})}):(0,t.jsxs)("div",{className:"min-vh-100 bg-light",children:[t.jsx("div",{className:"bg-white shadow-sm border-bottom",children:t.jsx("div",{className:"container-fluid py-3",children:(0,t.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,t.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[t.jsx(p(),{href:"/school-admin/dashboard",className:"btn btn-outline-secondary",children:t.jsx(r.Z,{size:20})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"h3 mb-0 fw-bold text-dark",children:[t.jsx("i",{className:"fas fa-chalkboard-teacher me-2 text-primary"}),"Teachers Management"]}),t.jsx("p",{className:"text-muted mb-0",children:"Manage all teachers in your school"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("button",{className:"btn btn-outline-secondary me-2",onClick:fetchTeachers,title:"Refresh teachers list",children:[t.jsx("i",{className:"fas fa-sync-alt me-2"}),"Refresh"]}),(0,t.jsxs)("button",{className:"btn btn-outline-primary me-2",title:"Export to CSV",children:[t.jsx(n.Z,{size:18,className:"me-2"}),"Export"]})]})]})})}),(0,t.jsxs)("div",{className:"container-fluid py-4",children:[(0,t.jsxs)("div",{className:"row g-3 mb-4",children:[t.jsx("div",{className:"col-md-4",children:(0,t.jsxs)("div",{className:"input-group",children:[t.jsx("span",{className:"input-group-text bg-white border-end-0",children:t.jsx(i.Z,{size:18,className:"text-muted"})}),t.jsx("input",{type:"text",className:"form-control border-start-0",placeholder:"Search teachers by name, email, department...",value:N,onChange:e=>f(e.target.value)})]})}),t.jsx("div",{className:"col-md-2",children:(0,t.jsxs)("select",{className:"form-select",value:v,onChange:e=>y(e.target.value),children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"inactive",children:"Inactive"}),t.jsx("option",{value:"resigned",children:"Resigned"}),t.jsx("option",{value:"retired",children:"Retired"}),t.jsx("option",{value:"suspended",children:"Suspended"})]})}),t.jsx("div",{className:"col-md-2",children:(0,t.jsxs)("select",{className:"form-select",value:w,onChange:e=>C(e.target.value),children:[t.jsx("option",{value:"all",children:"All Departments"}),(()=>{let s=e.map(e=>e.department).filter((e,s,a)=>e&&a.indexOf(e)===s).sort();return s})().map(e=>t.jsx("option",{value:e,children:e},e))]})}),t.jsx("div",{className:"col-md-2",children:(0,t.jsxs)("select",{className:"form-select",value:`${P}-${$}`,onChange:e=>{let[s,a]=e.target.value.split("-");k(s),L(a)},children:[t.jsx("option",{value:"name-asc",children:"Name A-Z"}),t.jsx("option",{value:"name-desc",children:"Name Z-A"}),t.jsx("option",{value:"email-asc",children:"Email A-Z"}),t.jsx("option",{value:"email-desc",children:"Email Z-A"}),t.jsx("option",{value:"department-asc",children:"Department A-Z"}),t.jsx("option",{value:"department-desc",children:"Department Z-A"}),t.jsx("option",{value:"experience-desc",children:"Experience High-Low"}),t.jsx("option",{value:"experience-asc",children:"Experience Low-High"})]})}),t.jsx("div",{className:"col-md-2",children:(0,t.jsxs)("div",{className:"d-flex gap-2",children:[t.jsx("button",{className:"btn btn-outline-secondary flex-fill",onClick:()=>{f(""),y("all"),C("all"),k("name"),L("asc"),S(1)},title:"Clear all filters",children:t.jsx(c.Z,{size:16})}),(0,t.jsxs)(p(),{href:"/school-admin/add-teacher",className:"btn btn-primary flex-fill",children:[t.jsx(d.Z,{size:16,className:"me-1"}),"Add"]})]})})]}),(0,t.jsxs)("div",{className:"card border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white border-0 py-3",children:(0,t.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,t.jsxs)("h5",{className:"mb-0 fw-bold text-dark",children:["Teachers List",(0,t.jsxs)("span",{className:"badge bg-primary ms-2",children:[a.length," teachers"]}),a.length!==e.length&&(0,t.jsxs)("span",{className:"badge bg-secondary ms-1",children:[e.length," total"]})]}),(0,t.jsxs)("div",{className:"text-muted small",children:["Showing ",Math.min((_-1)*A+1,a.length)," to ",Math.min(_*A,a.length)," of ",a.length," results",!1]})]})}),t.jsx("div",{className:"card-body p-0",children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-5",children:[t.jsx(o.Z,{size:48,className:"text-muted mb-3"}),t.jsx("h5",{className:"text-muted",children:"No teachers found"}),t.jsx("p",{className:"text-muted",children:N||"all"!==v||"all"!==w?"Try adjusting your search or filters":"No teachers have been added yet"}),(0,t.jsxs)(p(),{href:"/school-admin/add-teacher",className:"btn btn-primary",children:[t.jsx(d.Z,{size:18,className:"me-2"}),"Add Teacher"]})]}):t.jsx("div",{className:"table-responsive",children:(0,t.jsxs)("table",{className:"table table-hover mb-0",children:[t.jsx("thead",{className:"table-light",children:(0,t.jsxs)("tr",{children:[(0,t.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("name"),style:{cursor:"pointer"},children:["Teacher","name"===P&&t.jsx("i",{className:`fas fa-sort-${"asc"===$?"up":"down"} ms-1`})]}),(0,t.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("email"),style:{cursor:"pointer"},children:["Contact","email"===P&&t.jsx("i",{className:`fas fa-sort-${"asc"===$?"up":"down"} ms-1`})]}),(0,t.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("department"),style:{cursor:"pointer"},children:["Department","department"===P&&t.jsx("i",{className:`fas fa-sort-${"asc"===$?"up":"down"} ms-1`})]}),t.jsx("th",{className:"border-0",children:"Assigned Classes"}),(0,t.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("experience"),style:{cursor:"pointer"},children:["Experience","experience"===P&&t.jsx("i",{className:`fas fa-sort-${"asc"===$?"up":"down"} ms-1`})]}),(0,t.jsxs)("th",{className:"border-0 cursor-pointer",onClick:()=>handleSort("status"),style:{cursor:"pointer"},children:["Status","status"===P&&t.jsx("i",{className:`fas fa-sort-${"asc"===$?"up":"down"} ms-1`})]}),t.jsx("th",{className:"border-0",children:"Actions"})]})}),t.jsx("tbody",{children:(()=>{let e=(_-1)*A,s=e+A;return a.slice(e,s)})().map(e=>(0,t.jsxs)("tr",{children:[t.jsx("td",{children:(0,t.jsxs)("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"40px",height:"40px"},children:t.jsx("span",{className:"text-success fw-bold",children:getInitials(e.firstName,e.lastName)})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"fw-semibold",children:[e.firstName," ",e.lastName]}),t.jsx("small",{className:"text-muted",children:e.employeeId||`ID: ${e.id}`})]})]})}),(0,t.jsxs)("td",{children:[t.jsx("div",{className:"text-muted small",children:e.email}),t.jsx("small",{className:"text-muted",children:e.mobile||"No mobile"})]}),t.jsx("td",{children:e.department?t.jsx("span",{className:"badge bg-info",children:e.department}):t.jsx("span",{className:"text-muted small",children:"Not assigned"})}),t.jsx("td",{children:e.classes&&e.classes.length>0?t.jsx("div",{className:"d-flex flex-wrap gap-1",children:e.classes.map((e,s)=>(0,t.jsxs)("span",{className:`badge ${e.isPrimary?"bg-primary":"bg-secondary"}`,title:e.isPrimary?"Primary Class":"Additional Class",children:[e.name,e.isPrimary&&" ⭐"]},s))}):t.jsx("span",{className:"text-muted small",children:"No classes assigned"})}),t.jsx("td",{children:e.experienceYears?(0,t.jsxs)("span",{className:"badge bg-warning text-dark",children:[e.experienceYears," years"]}):t.jsx("span",{className:"text-muted small",children:"N/A"})}),t.jsx("td",{children:t.jsx("span",{className:`badge ${"active"===e.status?"bg-success":"inactive"===e.status?"bg-secondary":"resigned"===e.status?"bg-info":"retired"===e.status?"bg-warning":"suspended"===e.status?"bg-danger":"bg-secondary"}`,children:e.status})}),t.jsx("td",{children:(0,t.jsxs)("div",{className:"btn-group",role:"group",children:[t.jsx(p(),{href:`/school-admin/teachers/${e.id}`,className:"btn btn-sm btn-outline-primary",title:"View Details",children:t.jsx(h.Z,{size:16})}),t.jsx(p(),{href:`/school-admin/teachers/${e.id}/edit`,className:"btn btn-sm btn-outline-warning",title:"Edit",children:t.jsx(m.Z,{size:16})}),t.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>handleDeleteTeacher(e.id),title:"Delete",children:t.jsx(x.Z,{size:16})})]})})]},e.id))})]})})})]}),a.length>A&&(0,t.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[(0,t.jsxs)("div",{className:"text-muted",children:["Showing ",Math.min((_-1)*A+1,a.length)," to ",Math.min(_*A,a.length)," of ",a.length," teachers"]}),t.jsx("nav",{"aria-label":"Teachers pagination",children:(0,t.jsxs)("ul",{className:"pagination pagination-sm mb-0",children:[t.jsx("li",{className:`page-item ${1===_?"disabled":""}`,children:t.jsx("button",{className:"page-link",onClick:()=>handlePageChange(_-1),disabled:1===_,children:"Previous"})}),Array.from({length:Math.min(5,E)},(e,s)=>{let a;return a=E<=5?s+1:_<=3?s+1:_>=E-2?E-4+s:_-2+s,t.jsx("li",{className:`page-item ${_===a?"active":""}`,children:t.jsx("button",{className:"page-link",onClick:()=>handlePageChange(a),children:a})},a)}),t.jsx("li",{className:`page-item ${_===E?"disabled":""}`,children:t.jsx("button",{className:"page-link",onClick:()=>handlePageChange(_+1),disabled:_===E,children:"Next"})})]})})]})]})]})}},13326:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>n,__esModule:()=>r,default:()=>c});var t=a(95153);let l=(0,t.createProxy)(String.raw`C:\xampp\htdocs\childclub\childclub-frontend\src\app\school-admin\teachers\page.tsx`),{__esModule:r,$$typeof:n}=l,i=l.default,c=i}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[659,1336,9675,3528,4301,4154,950,3593,656,5525,7565],()=>__webpack_exec__(96789));module.exports=a})();